(()=>{var t,e={1245:(t,e,a)=>{var n=a(4692);a(7081),a(9875),a(5194),a(97),a(7776),a(5219),a(9145),a(1453),n(document).ready((function(){function t(){n.ajax({type:"GET",url:"/api/ai/get/current_data",contentType:"application/json"}).done((function(t){!function(t){if(t.cluster_status){n("#cluster-status").text(t.cluster_status.status||"N/A");const e=t.cluster_status.processed||0,a=t.cluster_status.total||0;n("#cluster-availability").text(`${e} / ${a}`)}else n("#cluster-status").text("N/A"),n("#cluster-availability").text(0);if(t.ai_status?(n("#ai-running-count").text(t.ai_status.running||0),n("#ai-queue-count").text(t.ai_status.queued||0)):(n("#ai-running-count").text(0),n("#ai-queue-count").text(0)),t.flags&&(n("#toggle-system-switch").prop("checked",t.flags.system).trigger("change"),n("#toggle-ai-switch").prop("checked",t.flags.ai).trigger("change")),t.sim_methods){const e=n("#clustering-process-select");e.empty(),t.sim_methods.forEach((function(t){const a=n("<option></option>").attr("value",t.name).text(`${t.name}: ${t.description}`).prop("selected",t.selected);e.append(a)}))}const a=t.cluster_status.processed,r=t.cluster_status.total,o=t.cluster_status.status;n("#progress-status").text(`Status: ${o}`),n("#progress-bar").css("width",a/r*100+"%"),n("#progress-bar").attr("aria-valuenow",a),n("#progress-bar").text(`${a}/${r}`),null!==t.ai_status.response&&n("#ai-response").text(t.ai_status.response),null!==t.ai_status.query&&n("#ai-query").text(t.ai_status.query),function(t){const a=n("#cluster-table tbody"),r=n("#cluster-table");n.fn.dataTable.isDataTable(r)&&r.DataTable().clear().destroy(),a.empty(),Array.isArray(t)&&0!==t.length?(t.sort(((t,a)=>e(t).localeCompare(e(a)))),t.forEach((t=>{if(!Array.isArray(t))return void console.error("Invalid cluster structure:",t);t.sort(((t,e)=>t.localeCompare(e)));const e=`Cluster ${t[0]}`,n=function(t){return t.map((t=>`<span class="badge bg-info">\n                <a href="${base_url}?command=search&col=2&q=%5C%22${t}%5C%22" target="_blank" class="link-light">${t}</a>\n            </span>`)).join(" ")}(t),r=t.map((t=>`%5C%22${t}%5C%22`)).join("%3AOR%3A"),o=`<tr>\n                            <td>${e}</td>\n                            <td>${n} ${t.length>1?`<span class="badge bg-info">\n                    <a href="${base_url}?command=search&col=2&q=${r}" target="_blank" class="link-light">Show all</a>\n                </span>`:""}</td>\n                            <td>${t.length}</td>\n                        </tr>`;a.append(o)})),r.DataTable({paging:!0,stateSave:!0,pageLength:10,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',columnDefs:[{targets:2,orderDataType:"dom-text"}],order:[[2,"desc"]]})):console.error("Invalid or empty data.")}(t.clusters),function(t){n.fn.dataTable.isDataTable("#ai-progress-table")&&n("#ai-progress-table").DataTable().clear().destroy();const e=n("#ai-progress-table tbody");e.empty(),t.forEach((t=>{const a=t.id||"N/A",n=t.prompt?t.prompt:"N/A",r=t.status||"N/A",o=t.ai_response?JSON.stringify(t.ai_response,null,2):"N/A",s=t.try_count||"X",i=Math.floor(Date.now()/10),c=t.time?Math.max(0,Math.ceil(9-(i-t.time))):"N/A",l=`\n                <tr id="row-${a}">\n                    <td>${a}</td>\n                    <td>${n}</td>\n                    <td>${r}</td>\n                    <td>${o}</td>\n                    <td>${s}</td>td>\n                    <td id="countdown-${a}">${"N/A"!==c?`${c} sec`:c}</td>\n                </tr>\n            `;e.append(l)})),n("#ai-progress-table").DataTable({paging:!0,stateSave:!0,pageLength:10,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',order:[[0,"asc"]]})}(t.ai_formalization)}(t)}))}function e(t){return Array.isArray(t)&&0!==t.length?t.map((t=>t.toString())).sort()[0]:""}n("#terminate-all-button").click((function(){n.ajax({type:"POST",url:"/api/ai/terminate/all",contentType:"application/json"}).done((function(t){alert(t.message)})).fail((function(t){alert(`Error: ${t.responseText}`)}))})),n("#toggle-system-switch").on("change",(function(){const t=n(this).is(":checked");n.ajax({type:"POST",url:"/api/ai/set/flag/system",contentType:"application/json",data:JSON.stringify({system_enabled:t})})})),n("#toggle-ai-switch").on("change",(function(){const t=n(this).is(":checked");n.ajax({type:"POST",url:"/api/ai/set/flag/ai",contentType:"application/json",data:JSON.stringify({ai_enabled:t})})})),n("#clustering-process-select").on("change",(function(){const e=n(this).val();n.ajax({type:"POST",url:"/api/ai/set/method/sim",contentType:"application/json",data:JSON.stringify({name:e}),success:function(e){console.log(e.message),t()},error:function(t){console.error("Error setting method:",t)}})})),n("#start-clustering").click((function(){n.ajax({type:"POST",url:"/api/ai/set/sim/start",contentType:"application/json"})})),n("#terminate-clustering-button").click((function(){n.ajax({type:"POST",url:"/api/ai/terminate/sim",contentType:"application/json"})})),n("#terminate-ai-button").click((function(){n.ajax({type:"POST",url:"/api/ai/terminate/ai",contentType:"application/json"})})),n("#process-ai").click((function(){n.ajax({type:"POST",url:"/api/ai/ai/process",contentType:"application/json"})})),n("#submit-prompt-button").click((function(){var t=n("#user-prompt").val();t?n.ajax({type:"POST",url:"/api/ai/ai/query",contentType:"application/json",data:JSON.stringify({query:t}),success:function(t){n("#ai-response").text("Processing your query...")},error:function(t,e,a){n("#ai-response").text("Error: "+t.responseJSON.error)}}):alert("Please enter a prompt!")})),n("#get-matrix-button").click((function(){n.ajax({type:"GET",url:"/api/ai/get/sim/matrix",contentType:"application/json"}).done((function(t){const e=document.getElementById("similarity-matrix"),a=e.querySelector("thead"),n=e.querySelector("tbody");a.innerHTML="",n.innerHTML="";const r=t.matrix,o=t.indexing,s=document.createElement("tr");s.appendChild(document.createElement("th")),Object.keys(o).forEach((t=>{const e=document.createElement("th");e.textContent=t,s.appendChild(e)})),a.appendChild(s),Object.keys(o).forEach(((t,e)=>{const a=document.createElement("tr"),o=document.createElement("th");o.textContent=t,a.appendChild(o),r[e].forEach((t=>{const e=document.createElement("td");e.textContent=t.toFixed(2),e.style.backgroundColor=function(t){const e=Math.round(255*t);return`rgb(${255-e}, ${255-e}, 255)`}(t),a.appendChild(e)})),n.appendChild(a)}))})).fail((function(){const t=document.getElementById("similarity-matrix"),e=t.querySelector("thead"),a=t.querySelector("tbody");e.innerHTML="",a.innerHTML=""}))})),t(),setInterval(t,1e3)}))}},a={};function n(t){var r=a[t];if(void 0!==r)return r.exports;var o=a[t]={id:t,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.exports}n.m=e,t=[],n.O=(e,a,r,o)=>{if(!a){var s=1/0;for(u=0;u<t.length;u++){for(var[a,r,o]=t[u],i=!0,c=0;c<a.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((t=>n.O[t](a[c])))?a.splice(c--,1):(i=!1,o<s&&(s=o));if(i){t.splice(u--,1);var l=r();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,r,o]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.j=53,(()=>{var t={53:0};n.O.j=e=>0===t[e];var e=(e,a)=>{var r,o,[s,i,c]=a,l=0;if(s.some((e=>0!==t[e]))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(c)var u=c(n)}for(e&&e(a);l<s.length;l++)o=s[l],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},a=self.webpackChunkhanfor=self.webpackChunkhanfor||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})(),n.nc=void 0;var r=n.O(void 0,[223],(()=>n(1245)));r=n.O(r)})();