(()=>{var e,t={228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,s),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},985:(e,t,n)=>{var r=n(4692);const{init_simulator_modal:i}=n(6199);function o(e,t,n=!1){if(id=t.simulator_id,name=t.simulator_name,n)return e.prepend(r("<option></option>").val(id).text(name+" ("+id+")")),void e.prop("selectedIndex",0);e.empty(),r.each(t.simulators,(function(t,n){e.prepend(r("<option></option>").val(t).text(n+" ("+t+")"))}))}function s(e){let t=[];return e.DataTable().rows({selected:!0}).every((function(){t.push(this.data().id)})),t}t.init_simulator_tab=function(){const e=r("#simulator-tab-name-input"),t=r("#simulator-tab-select"),n=r("#simulator-tab-create-btn"),a=r("#simulator-tab-delete-btn"),c=r("#simulator-tab-start-btn"),u=r("#requirements_table");r.ajax({type:"GET",url:"simulator",async:!1,data:{command:"get_simulators"},success:function(e){!1!==e.success?o(t,e.data):alert(e.errormsg)}}),n.click((function(){r.ajax({type:"POST",url:"simulator",async:!1,data:{command:"create_simulator",simulator_name:e.val()||"unnamed",requirement_ids:JSON.stringify(s(u))},success:function(e){!1!==e.success?o(t,e.data,!0):alert(e.errormsg)}})})),a.click((function(){r.ajax({type:"DELETE",url:"simulator",async:!1,data:{command:"delete_simulator",simulator_id:t.val()},success:function(e){!1!==e.success?o(t,e.data):alert(e.errormsg)}})})),c.click((function(){r.ajax({type:"GET",url:"simulator",async:!1,data:{command:"start_simulator",simulator_id:t.val()},success:function(e){!1!==e.success?i(e.data):alert(e.errormsg)}})}))}},1251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateElementOffset=void 0,t.calculateElementOffset=e=>{const t=e.getBoundingClientRect(),n=e.ownerDocument;if(null==n)throw new Error("Given element does not belong to document");const{defaultView:r,documentElement:i}=n;if(null==r)throw new Error("Given element does not belong to window");const o={top:t.top+r.pageYOffset,left:t.left+r.pageXOffset};return i&&(o.top-=i.clientTop,o.left-=i.clientLeft),o}},1521:(e,t,n)=>{var r=n(4692);n(7081);const{Collapse:i,Modal:o}=n(9875);n(5194),n(6628),n(97),n(7776),n(4371),n(5219),n(9145),n(1453),n(8131);let s=n(879);const a=n(9692),{SearchNode:c}=n(1108),{init_simulator_tab:u}=n(985),{sendTelemetry:l}=n(6719),{Textcomplete:h}=n(6e3),{TextareaEditor:d}=n(9787);let f,p,v=n(8357),m=new v([],{}),g=["","has_formalization"],y=["","Todo","Review","Done"],_=[":AND:",":OR:",":NOT:",":COL_INDEX_01:",":COL_INDEX_02:",":COL_INDEX_03:",":COL_INDEX_04:",":COL_INDEX_05:",":COL_INDEX_06:",":COL_INDEX_07:"],b=[""],C=[""],E=[],w=[!0,!0,!0,!0,!0,!0],x=[],A=JSON.parse(search_query),O={},k=[],D=sessionStorage.getItem("req_search_string"),S=sessionStorage.getItem("filter_status_string"),L=sessionStorage.getItem("filter_tag_string"),M=sessionStorage.getItem("filter_type_string");function I(){D=r("#search_bar").val().trim(),sessionStorage.setItem("req_search_string",D),f=c.fromQuery(D)}function F(){function e(e,t,n){return t.length>0&&(e.length>0&&(e=e.concat([":AND:"])),e=e.concat(function(e){return["("].concat(e,[")"])}(c.awesomeQuerySplitt0r(t,n)))),e}x=[],S=r("#status-filter-input").val(),L=r("#tag-filter-input").val(),M=r("#type-filter-input").val(),sessionStorage.setItem("filter_status_string",S),sessionStorage.setItem("filter_tag_string",L),sessionStorage.setItem("filter_type_string",M),x=e(x,M,4),x=e(x,L,5),x=e(x,S,6),p=c.searchArrayToTree(x)}function N(){let e=r("#requirements_table").DataTable(),t=[];r.each(e.columns().visible(),(function(e,n){!1===n?(r("#col_toggle_button_"+e).removeClass("btn-info").addClass("btn-secondary"),t.push(!1)):(r("#col_toggle_button_"+e).removeClass("btn-secondary").addClass("btn-info"),t.push(!0))})),w=t}function T(e){let t=[];return e.rows({selected:!0}).every((function(){let e=this.data();t.push(e.id)})),t}function q(){r.get("api/logs/get","",(function(e){r("#log_textarea").html(e)})).done((function(){r(".req_direct_link").click((function(){B(function(e){let t=r("#requirements_table").DataTable(),n=-1;return t.data().filter((function(t,r){return String(t.id)===String(e)&&(n=r,!0)})),n}(r(this).data("rid")))})),r("#log_textarea").scrollTop(1e5)}))}function B(e){if(-1===e)return void alert("Requirement not found.");W();let t=r("#requirements_table").DataTable().row(e).data(),n=r(".modal-content");o.getOrCreateInstance("#requirement_modal").show(),n.LoadingOverlay("show"),r("#formalization_accordion").html(""),r("#requirement_tag_field").data("bs.tokenfield").$input.autocomplete({source:g}),r.get("api/req/get",{id:t.id,row_idx:e},(function(t){if(!1===t.success)return void alert("Could Not load the Requirement: "+t.errormsg);r("#requirement_id").val(t.id),r("#modal_associated_row_index").val(e),C=t.available_vars,C=C.concat(t.additional_static_available_vars),k=t.type_inference_errors,m=new v(C,{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:12,minMatchCharLength:1,keys:[]}),r("#requirement_modal_title").html(t.id+": "+t.type),r("#description_textarea").text(t.desc).change(),r("#add_guess_description").text(t.desc).change(),r("#formalization_accordion").html(t.formalizations_html),r("#requirement_scope").val(t.scope),r("#requirement_pattern").val(t.pattern),r("#tags_comments_table").find("tr:gt(0)").remove(),r("#requirement_tag_field").tokenfield("setTokens",t.tags),r("#tags_comments_table tr:gt(0)").each((function(){let e=r(this).find("td:eq(0)").text();r(this).find("textarea:eq(0)").val(t.tags_comments[e])})),r("#requirement_status").val(t.status);let n=r("#csv_content_accordion");n.html("");let i=t.csv_data;for(const e in i)if(i.hasOwnProperty(e)){const t=i[e];n.append("<p><strong>"+e+":</strong>"+t+"</p>")}let o=r("#show_revision_diff");r.isEmptyObject(t.revision_diff)?o.hide():o.show();let s=r("#revision_diff_accordion");s.html("");let a=t.revision_diff;for(const e in a)if(a.hasOwnProperty(e)){const t=a[e];s.append("<p><strong>"+e+":</strong><pre>"+t+"</pre></p>")}let c=r("#used_variables_accordion");c.html(""),t.vars.forEach((function(e){let t="?command=search&col=1&q=%5C%22"+e+"%5C%22";c.append('<span class="badge bg-info"><a href="./variables'+t+'" target="_blank">'+e+"</a></span>&numsp;")}))})).done((function(){$(),P(),R(),r("#requirement_modal").data({unsaved_changes:!1,updated_formalization:!1}),n.LoadingOverlay("hide",!0),l("requirements",t.id,"open")}))}function P(){r(".reqirement-variable").each((function(){j(this)}))}function j(e){const t=new h(new d(e),[{match:/(|\s|[!=&\|>]+)(\w+)$/,index:2,search:function(e,t,n){let r=function(e){return m.search(e)}(e),i=[];for(let e=0;e<Math.min(10,r.length);e++)i.push(C[r[e].refIndex]);t(i)},replace:function(e){return"$1"+e+" "}}],{dropdown:{className:"dropdown-menu textcomplete-dropdown",maxCount:10,style:{display:"none",position:"absolute",zIndex:"9999"},item:{className:"dropdown-item",activeClassName:"dropdown-item active"}}});r(document).on("click",(function(e){t!==e.target&&t.hide()}))}function R(){r(".formalization_card").each((function(){const e=r(this).attr("title");let t="",n=r("#current_formalization_textarea"+e);const i=r("#requirement_scope"+e).find("option:selected").text().replace(/\s\s+/g," "),o=r("#requirement_pattern"+e).find("option:selected").text().replace(/\s\s+/g," ");"None"!==i&&"None"!==o&&(t=i+", "+o+".");let s=r("#formalization_var_p"+e).val(),c=r("#formalization_var_q"+e).val(),u=r("#formalization_var_r"+e).val(),l=r("#formalization_var_s"+e).val(),h=r("#formalization_var_t"+e).val(),d=r("#formalization_var_u"+e).val(),f=r("#formalization_var_v"+e).val();s.length>0&&(t=t.replace(/{P}/g,z(s))),c.length>0&&(t=t.replace(/{Q}/g,z(c))),u.length>0&&(t=t.replace(/{R}/g,z(u))),l.length>0&&(t=t.replace(/{S}/g,z(l))),h.length>0&&(t=t.replace(/{T}/g,z(h))),d.length>0&&(t=t.replace(/{U}/g,z(d))),f.length>0&&(t=t.replace(/{V}/g,z(f))),n.html(t),a.update(n)})),r("#requirement_modal").data({unsaved_changes:!0,updated_formalization:!0})}function z(e){let t="";return e.split(/([\s&<>!()=:\[\]{}\-|+*,])/g).forEach((function(e){C.includes(e)?t+='<a href="./variables?command=search&col=1&q=%5C%22'+e+'%5C%22" target="_blank"  title="Go to declaration of '+e+'" class="alert-link">'+e+"</a>":t+=s.escapeHtml(e)})),t}function $(){r(".requirement_var_group").each((function(){r(this).hide(),r(this).removeClass("type-error")})),r(".formalization_card").each((function(){const e=r(this).attr("title"),t=r("#requirement_scope"+e).val(),n=r("#requirement_pattern"+e).val();let i=r("#formalization_heading"+e),o=r("#requirement_var_group_p"+e),s=r("#requirement_var_group_q"+e),a=r("#requirement_var_group_r"+e),c=r("#requirement_var_group_s"+e),u=r("#requirement_var_group_t"+e),l=r("#requirement_var_group_u"+e),h=r("#requirement_var_group_v"+e);if(e in k)for(let t=0;t<k[e].length;t++)r("#formalization_var_"+k[e][t]+e).addClass("type-error"),i.addClass("type-error-head");else i.removeClass("type-error-head");switch(t){case"BEFORE":case"AFTER":o.show();break;case"BETWEEN":case"AFTER_UNTIL":o.show(),s.show()}Object.keys(_PATTERNS[n].env).forEach((function(e){switch(e){case"R":a.show();break;case"S":c.show();break;case"T":u.show();break;case"U":l.show();break;case"V":h.show()}}))}))}function W(){r.ajax({type:"GET",url:"api/tags/"}).done((function(e){g=[];for(let t of e)g.push(t.name),O[t.name]=t.color})).fail((function(e,t,n){alert(n+"\n\n"+e.responseText)}))}function U(e=!1){let t=r("#report_query_textarea"),n=r("#report_results_textarea"),i=r("#report_modal_title"),s=r("#report_name"),a="",c="",u="",l=-1;r("#report_modal"),!1!==e&&(l=e.attr("data-id"),a=E[l].queries,c=E[l].results,u=E[l].name),t.val(a).change(),n.val(c).change(),s.val(u).change(),i.html(u),r("#save_report").attr("data-id",l),o.getOrCreateInstance(document.querySelector("#report_modal")).show()}function H(){r.get("api/report/get",{},(function(e){if(!1===e.success)alert(e.errormsg);else{let t="";E=e.data,r.each(e.data,(function(e,n){t+=`<div class="card border-primary">\n                              <div class="card-body">\n                                <h5 class="card-title">${n.name}</h5>\n                                <h6 class="card-subtitle mb-2 text-muted">Query</h6>\n                                <p class="card-text report-results">${n.queries}</p>\n                                <h6 class="card-subtitle mb-2 text-muted">Matches for queries</h6>\n                                <p class="card-text report-results">${n.results}</p>\n                                <a href="#" class="card-link open-report" data-id="${e}">\n                                    Edit (reevaluate) Report.\n                                </a>\n                                <a href="#" class="card-link delete-report" data-id="${e}">Delete Report.</a>\n                              </div>\n                            </div>`})),r("#available_reports").html(t)}}))}r(document).ready((function(){W(),function(){let e=r("#search_bar");new Awesomplete(e[0],{filter:function(e,t){let n=!1;return(t.split(":").length-1)%2==1&&(n=Awesomplete.FILTER_CONTAINS(e,t.match(/[^:]*$/)[0])),n},item:function(e,t){return Awesomplete.ITEM(e,t.match(/(:)([\S]*$)/)[2])},replace:function(e){const t=this.input.value.match(/(.*)(:(?!.*:).*$)/)[1];this.input.value=t+e},list:_,minChars:1,autoFirst:!0})}(),function(){let e=[{orderable:!1,className:"select-checkbox",targets:[0],data:null,defaultContent:""},{targets:[1],data:"pos"},{targets:[2],data:"id",render:function(e){return'<a href="#">'+s.escapeHtml(e)+"</a>"}},{targets:[3],data:"desc",render:function(e){return'<div class="white-space-pre">'+s.escapeHtml(e)+"</div>"}},{targets:[4],data:"type",render:function(e){return b.indexOf(e)<=-1&&b.push(e),s.escapeHtml(e)}},{targets:[5],data:"tags",render:function(e,t,n){let i="";return r(e).each((function(e,t){var n;t.length>0&&(i+='<span class="badge" style="background-color: '+(n=t,(O.hasOwnProperty(n)?O[n]:"var(--bs-info)")+'">')+s.escapeHtml(t)+"</span></br> ")})),i}},{targets:[6],data:"status",render:function(e){return'<span class="badge bg-info">'+e+"</span></br>"}},{targets:[7],data:"formal",render:function(e,t,n){let i="";return n.formal.length>0&&r(e).each((function(e,t){t.length>0&&(i+='<div class="white-space-pre">'+s.escapeHtml(t)+"</div>")})),i}}];r.get("api/req/colum_defs","",(function(t){const n=t.col_defs.length;for(let r=0;r<n;r++)e.push({targets:[parseInt(t.col_defs[r].target)],data:t.col_defs[r].csv_name,visible:!1,searchable:!0})})).done((function(){!function(e){let t=r("#requirements_table").DataTable({language:{emptyTable:"Loading data."},paging:!0,stateSave:!0,select:{style:"os",selector:"td:first-child"},order:[[1,"asc"]],pageLength:50,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',ajax:"api/req/gets",deferRender:!0,columnDefs:e,createdRow:function(e,t){"Heading"===t.type&&r(e).addClass("bg-primary"),"Information"===t.type&&r(e).addClass("table-info"),"Requirement"===t.type&&r(e).addClass("table-warning"),"not set"===t.type&&r(e).addClass("table-light")},infoCallback:function(e,t,n,i,o){let s=this.api().page.info();r("#clear-all-filters-text").html("Showing "+o+"/"+s.recordsTotal+". Clear all.");let a="Showing "+t+" to "+n+" of "+o+" entries";return a+=" (filtered from "+s.recordsTotal+" total entries).",a},initComplete:function(){r("#search_bar").val(D),r("#type-filter-input").val(M),r("#tag-filter-input").val(L),r("#status-filter-input").val(S);let e=this.api();!function(e){r("#requirements_table").find("tbody").on("click","a",(function(t){t.preventDefault(),B(e.row(r(this).closest("tr")).index())}))}(e),function(e){e.columns().every((function(t){t>0&&e.column(t).header().append(" ("+t+")")})),r("#save_requirement_modal").click((function(){!function(e){let t=r(".modal-content");t.LoadingOverlay("show");const n=r("#requirement_id").val(),i=r("#requirement_status").val(),s=r("#requirement_modal").data("updated_formalization"),a=parseInt(r("#modal_associated_row_index").val());let c={};r(".formalization_card").each((function(){let e={};e.id=r(this).attr("title"),r(this).find("select").each((function(){r(this).hasClass("scope_selector")&&(e.scope=r(this).val()),r(this).hasClass("pattern_selector")&&(e.pattern=r(this).val())})),e.expression_mapping={},r(this).find("textarea.reqirement-variable").each((function(){""!==r(this).attr("title")&&(e.expression_mapping[r(this).attr("title")]=r(this).val())})),c[e.id]=e}));let u=new Map;r("#tags_comments_table tr:gt(0)").each((function(){let e=r(this).find("td:eq(0)").text(),t=r(this).find("textarea:eq(0)").val();u.set(e,t)})),l("requirements",n,"save"),r.post("api/req/update",{id:n,row_idx:a,update_formalization:s,tags:JSON.stringify(Object.fromEntries(u)),status:i,formalizations:JSON.stringify(c)},(function(n){if(t.LoadingOverlay("hide",!0),!1===n.success)alert(n.errormsg);else{e.row(a).data(n),r("#requirement_modal").data("unsaved_changes",!1);const t=document.querySelector("#requirement_modal");o.getOrCreateInstance(t).hide()}})).done((function(){q()}))}(e)})),r("#search_bar").keypress((function(t){13===t.which&&(I(),e.draw())})),r("#type-filter-input").autocomplete({minLength:0,source:b,delay:100}),r("#status-filter-input").autocomplete({minLength:0,source:y,delay:100}),r("#tag-filter-input").autocomplete({minLength:0,source:g,delay:100}),r("#tag-filter-input, #status-filter-input, #type-filter-input").on("focus",(function(){r(this).keydown()})).on("keypress",(function(t){13===t.which&&(F(),e.draw())})),r("#table-filter-toggle").click((function(){r("#tag-filter-input").autocomplete({source:g}),r("#type-filter-input").autocomplete({source:b})})),r(".clear-all-filters").click((function(){r("#status-filter-input").val("").effect("highlight",{color:"green"},500),r("#tag-filter-input").val("").effect("highlight",{color:"green"},500),r("#type-filter-input").val("").effect("highlight",{color:"green"},500),r("#search_bar").val("").effect("highlight",{color:"green"},500),F(),I(),e.draw()})),r("#gen-req-from-selection").click((function(){let t=[];e.rows({search:"applied"}).every((function(){let e=this.data();t.push(e.id)})),r("#selected_requirement_ids").val(JSON.stringify(t)),r("#generate_req_form").submit()})),r("#gen-csv-from-selection").click((function(){let t=[];e.rows({search:"applied"}).every((function(){let e=this.data();t.push(e.id)})),r("#selected_csv_requirement_ids").val(JSON.stringify(t)),r("#generate_csv_form").submit()})),r("#gen-xls-from-selection").click((function(){let t=[];e.rows({search:"applied"}).every((function(){let e=this.data();t.push(e.id)})),r("#selected_xls_requirement_ids").val(JSON.stringify(t)),r("#generate_xls_form").submit()})),r(".column-toggle-button").on("click",(function(t){t.preventDefault();let n=e.column(r(this).attr("data-column"));n.visible(!n.visible()),N()})),r(".reset-column-toggle").on("click",(function(t){t.preventDefault(),e.columns(".default-col").visible(!0),e.columns(".extra-col").visible(!1),N()})),N(),r(".select-all-button").on("click",(function(){r(this).hasClass("btn-secondary")?e.rows({page:"current"}).select():e.rows({page:"current"}).deselect(),r(".select-all-button").toggleClass("btn-secondary btn-primary")})),e.on("user-select",(function(){let e=r(".select-all-button");e.removeClass("btn-primary"),e.addClass("btn-secondary ")})),r("#multi-add-tag-input, #multi-remove-tag-input").autocomplete({minLength:0,source:g,delay:100}).on("focus",(function(){r(this).keydown()})).val(""),r("#multi-set-status-input").autocomplete({minLength:0,source:y,delay:100}).on("focus",(function(){r(this).keydown()})).val(""),r(".apply-multi-edit").click((function(){!function(e){let t=r("body");t.LoadingOverlay("show");let n=r("#multi-add-tag-input").val().trim(),i=r("#multi-remove-tag-input").val().trim(),o=r("#multi-set-status-input").val().trim(),s=T(e);r.post("api/req/multi_update",{add_tag:n,remove_tag:i,set_status:o,selected_ids:JSON.stringify(s)},(function(e){t.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):location.reload()}))}(e)})),r(".add_top_guess_button").bootstrapConfirmButton({onConfirm:function(){!function(e){let t=r("body");t.LoadingOverlay("show");let n=T(e),i=r("#top_guess_append_mode").val();r.post("api/req/multi_add_top_guess",{selected_ids:JSON.stringify(n),insert_mode:i},(function(e){t.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):location.reload()}))}(e)}})}(e);for(const t of init_table_connection_functions)t(e);s.process_url_query(A),I(),F(),r.fn.dataTable.ext.search.push((function(e,t){return function(e){return f.evaluate(e,w)&&p.evaluate(e,w)}(t)})),this.api().draw()}});new r.fn.dataTable.ColReorder(t,{})}(e)}))}(),function(){let e=r("#requirement_modal");r("#requirement_tag_field").tokenfield({autocomplete:{source:g,delay:100},showAutocompleteOnFocus:!0}).change((function(){e.data("unsaved_changes",!0)})),r("#requirement_status").change((function(){r("#requirement_modal").data("unsaved_changes",!0)})),e[0].addEventListener("hide.bs.modal",(function(e){!function(e){!0===r("#requirement_modal").data("unsaved_changes")?!0!==confirm("You have unsaved changes, do you really want to close?")?e.preventDefault():l("requirements",r("#requirement_id").val(),"close_without_save"):l("requirements",r("#requirement_id").val(),"close")}(e)})),r(document).keyup((function(e){if(r(".modal:visible").length&&27===e.keyCode){let e=r("input[type=text], textarea, select").filter(":focus");0===e.length?r("#requirement_guess_modal:visible").length?o.getOrCreateInstance("#requirement_guess_modal").hide():o.getOrCreateInstance("#requirement_modal").hide():e.each((function(){r(this).blur()}))}})),e.on("hidden.bs.modal",(function(){r("#requirement_tag_field").val(""),r("#requirement_tag_field-tokenfield").val("")})),r("#add_formalization").click((function(){!function(){let e=r(".modal-content");e.LoadingOverlay("show");const t=r("#requirement_id").val();r.post("api/req/new_formalization",{id:t},(function(t){if(e.LoadingOverlay("hide",!0),!1===t.success)alert(t.errormsg);else{let e=r(t.html);e.find(".reqirement-variable").each((function(){j(this)})),e.appendTo("#formalization_accordion")}})).done((function(){$(),R(),q()}))}()})),r("#add_gussed_formalization").click((function(){!function(){let e=r("#requirement_guess_modal"),t=r("#available_guesses_cards"),n=r(".modal-content"),i=r("#requirement_id").val();function s(e){let n='<div class="card">                    <div class="pl-1 pr-1">                        <p>'+e.string+'                        </p>                    </div>                    <button type="button" class="btn btn-success btn-sm add_guess"                            title="Add formalization"                            data-scope="'+e.scope+'"                            data-pattern="'+e.pattern+"\"                            data-mapping='"+JSON.stringify(e.mapping)+"'>                        <strong>+ Add this formalization +</strong>                    </button>                </div>";t.append(n)}new o(e,{keyboard:!1}),o.getOrCreateInstance(e).show(),n.LoadingOverlay("show"),t.html(""),r.post("api/req/get_available_guesses",{requirement_id:i},(function(e){if(!1===e.success)alert(e.errormsg);else for(let t=0;t<e.available_guesses.length;t++)s(e.available_guesses[t])})).done((function(){r(".add_guess").click((function(){!function(e,t,n){let i=r(".modal-content");i.LoadingOverlay("show");let o=r("#requirement_id").val();r.post("api/req/add_formalization_from_guess",{requirement_id:o,scope:e,pattern:t,mapping:JSON.stringify(n)},(function(e){i.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):r("#formalization_accordion").append(e.html)})).done((function(){$(),R(),P(),q()}))}(r(this).data("scope"),r(this).data("pattern"),r(this).data("mapping"))})),n.LoadingOverlay("hide",!0)}))}()})),r(".modal").on("hidden.bs.modal",(function(){r(".modal:visible").length?r("body").addClass("modal-open"):r("textarea").each((function(){a.destroy(r(this))}))})),r("#formalization_accordion").on("shown.bs.collapse",".card",(function(){r(this).find("textarea").each((function(){a(r(this)),a.update(r(this))}))})),$()}(),q(),function(){r("#add-new-report").click((function(){U()})),r("#eval_report").click((function(){!function(){let e=r("body");e.LoadingOverlay("show");const t=r("#report_query_textarea").val().split("\n");let n=r("#requirements_table").DataTable(),i="";const o=/^(:NAME:)(`(\w+)`)(.*)/;try{r.each(t,(function(e,t){let r=o.exec(t);null!=r&&(t=r[4],e=r[3]),f=c.fromQuery(t),n.draw();let s=n.page.info();i+=`"${e}":\t${s.recordsDisplay}\n`})),r("#report_results_textarea").val(i).change(),I(),n.draw()}catch(e){alert(e)}e.LoadingOverlay("hide",!0)}()})),r("#save_report").click((function(){!function(){let e=r("body");e.LoadingOverlay("show"),r.post("api/report/set",{report_querys:r("#report_query_textarea").val(),report_results:r("#report_results_textarea").val(),report_name:r("#report_name").val(),report_id:r("#save_report").attr("data-id")},(function(t){e.LoadingOverlay("hide",!0),!1===t.success&&alert(t.errormsg),H()}))}()}));let e=r("#available_reports");e.on("click",".open-report",(function(){U(r(this))})),e.on("click",".delete-report",(function(){!function(e){r.ajax({type:"DELETE",url:"api/report/delete",data:{report_id:e},success:function(e){!1===e.success&&alert(e.errormsg),H()}})}(r(this).attr("data-id"))})),r("#report_name").change((function(){r("#report_modal_title").html(r(this).val())})),H()}(),u();let e=r("body");r("body").bootstrapConfirmButton({selector:".delete_formalization",onConfirm:function(){!function(e,t){let n=r(".modal-content");n.LoadingOverlay("show");const i=r("#requirement_id").val();r.post("api/req/del_formalization",{requirement_id:i,formalization_id:e},(function(e){n.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):t.remove()})).done((function(){$(),R(),q()}))}(r(this).attr("name"),r(this).closest(".accordion-item"))}}),e.on("click",".delete_formalization1",(function(){bootstrapConfirmation({yesCallBack:function(){console.log("yes")},noCallBack:function(){console.log("no")},config:{closeIcon:!0,message:"This is an example.",title:"Example",no:{class:"btn btn-danger",text:"No"},yes:{class:"btn btn-success",text:"Yes"}}})})),e.on("change",".formalization_selector, .reqirement-variable, .req_var_type",(function(){R()})),e.on("change",".formalization_selector",(function(){$()})),document.getElementById("requirement_modal").addEventListener("shown.bs.modal",(function(){r(this).find("textarea").each((function(){a(r(this)),a.update(r(this))}))})),e.on("change focus","textarea",(function(){a(r(this)),a.update(r(this))})),r("#requirement_tag_field").on("tokenfield:createtoken",(function(e){let t=r(this).tokenfield("getTokens");for(const n of t)if(e.attrs.value===n.value)return!1})).on("tokenfield:createdtoken",(function(e){var t;t="<tr><td>"+e.attrs.value+"</td><td><textarea rows='1' class='form-control w-100' type='text'></textarea></td>",r("#tags_comments_table tbody").append(t)})).on("tokenfield:removedtoken",(function(e){r("#tags_comments_table tr:gt(0)").each((function(){let t=r(this);r(this).find("td:eq(0)").text()===e.attrs.value&&t.remove()}))}))}))},1960:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=void 0,t.isSafari=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},2531:(e,t,n)=>{"use strict";function r(e,t,n){const r=e.value,i=t+(n||""),o=document.activeElement;let s=0,a=0;for(;s<r.length&&s<i.length&&r[s]===i[s];)s++;for(;r.length-a-1>=0&&i.length-a-1>=0&&r[r.length-a-1]===i[i.length-a-1];)a++;s=Math.min(s,Math.min(r.length,i.length)-a),e.setSelectionRange(s,r.length-a);const c=i.substring(s,i.length-a);if(e.focus(),!document.execCommand("insertText",!1,c)){e.value=i;const t=document.createEvent("Event");t.initEvent("input",!0,!0),e.dispatchEvent(t)}return e.setSelectionRange(t.length,t.length),o.focus(),e}function i(e,t,n){const i=e.selectionEnd,o=e.value.substr(0,e.selectionStart)+t,s=e.value.substring(e.selectionStart,i)+(n||"")+e.value.substr(i);return r(e,o,s),e.selectionEnd=i+t.length,e}n.r(t),n.d(t,{update:()=>r,wrapCursor:()=>i})},2615:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Completer=void 0;const r=n(228),i=n(9099);class o extends r.EventEmitter{constructor(e){super(),this.handleQueryResult=e=>{this.emit("hit",{searchResults:e})},this.strategies=e.map((e=>new i.Strategy(e)))}destroy(){return this.strategies.forEach((e=>e.destroy())),this}run(e){for(const t of this.strategies)if(t.execute(e,this.handleQueryResult))return;this.handleQueryResult([])}}t.Completer=o},2665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomEvent=void 0;const n="undefined"!=typeof window&&!!window.CustomEvent;t.createCustomEvent=(e,t)=>{if(n)return new CustomEvent(e,t);const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,(null==t?void 0:t.cancelable)||!1,(null==t?void 0:t.detail)||void 0),r}},3103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResult=void 0;const n=/\$&/g,r=/\$(\d)/g;t.SearchResult=class{constructor(e,t,n){this.data=e,this.term=t,this.strategy=n}getReplacementData(e){let t=this.strategy.replace(this.data);if(null==t)return null;let i="";Array.isArray(t)&&(i=t[1],t=t[0]);const o=this.strategy.match(e);if(null==o||null==o.index)return null;const s=t.replace(n,o[0]).replace(r,((e,t)=>o[parseInt(t)]));return{start:o.index,end:o.index+o[0].length,beforeCursor:s,afterCursor:i}}replace(e,t){const n=this.getReplacementData(e);if(null!==n)return t=n.afterCursor+t,[[e.slice(0,n.start),n.beforeCursor,e.slice(n.end)].join(""),t]}render(){return this.strategy.renderTemplate(this.data,this.term)}getStrategyId(){return this.strategy.getId()}}},3271:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;const r=n(228),i=n(2665);class o extends r.EventEmitter{destroy(){return this}applySearchResult(e){throw new Error("Not implemented.")}getCursorOffset(){throw new Error("Not implemented.")}getBeforeCursor(){throw new Error("Not implemented.")}emitMoveEvent(e){const t=(0,i.createCustomEvent)("move",{cancelable:!0,detail:{code:e}});return this.emit("move",t),t}emitEnterEvent(){const e=(0,i.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",e),e}emitChangeEvent(){const e=(0,i.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",e),e}emitEscEvent(){const e=(0,i.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",e),e}getCode(e){switch(e.keyCode){case 9:case 13:return"ENTER";case 27:return"ESC";case 38:return"UP";case 40:return"DOWN";case 78:if(e.ctrlKey)return"DOWN";break;case 80:if(e.ctrlKey)return"UP"}return"OTHER"}}t.Editor=o},4871:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown=t.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=t.DEFAULT_DROPDOWN_ITEM_CLASS_NAME=t.DEFAULT_DROPDOWN_CLASS_NAME=t.DEFAULT_DROPDOWN_PLACEMENT=t.DEFAULT_DROPDOWN_MAX_COUNT=void 0;const r=n(228),i=n(2665);t.DEFAULT_DROPDOWN_MAX_COUNT=10,t.DEFAULT_DROPDOWN_PLACEMENT="auto",t.DEFAULT_DROPDOWN_CLASS_NAME="dropdown-menu textcomplete-dropdown",t.DEFAULT_DROPDOWN_ITEM_CLASS_NAME="textcomplete-item",t.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=`${t.DEFAULT_DROPDOWN_ITEM_CLASS_NAME} active`;class o extends r.EventEmitter{static create(e){const n=document.createElement("ul");n.className=e.className||t.DEFAULT_DROPDOWN_CLASS_NAME,Object.assign(n.style,{display:"none",position:"absolute",zIndex:"1000"},e.style);const r=e.parent||document.body;return null==r||r.appendChild(n),new o(n,e)}constructor(e,t){super(),this.el=e,this.option=t,this.shown=!1,this.items=[],this.activeIndex=null}render(e,n){const r=(0,i.createCustomEvent)("render",{cancelable:!0});return this.emit("render",r),r.defaultPrevented?this:(this.clear(),0===e.length?this.hide():(this.items=e.slice(0,this.option.maxCount||t.DEFAULT_DROPDOWN_MAX_COUNT).map(((e,t)=>{var n;return new s(this,t,e,(null===(n=this.option)||void 0===n?void 0:n.item)||{})})),this.setStrategyId(e[0]).renderEdge(e,"header").renderItems().renderEdge(e,"footer").show().setOffset(n).activate(0),this.emit("rendered",(0,i.createCustomEvent)("rendered")),this))}destroy(){var e;return this.clear(),null===(e=this.el.parentNode)||void 0===e||e.removeChild(this.el),this}select(e){const t={searchResult:e.searchResult},n=(0,i.createCustomEvent)("select",{cancelable:!0,detail:t});return this.emit("select",n),n.defaultPrevented||(this.hide(),this.emit("selected",(0,i.createCustomEvent)("selected",{detail:t}))),this}show(){if(!this.shown){const e=(0,i.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",e),e.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,i.createCustomEvent)("shown"))}return this}hide(){if(this.shown){const e=(0,i.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",e),e.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.clear(),this.emit("hidden",(0,i.createCustomEvent)("hidden"))}return this}clear(){return this.items.forEach((e=>e.destroy())),this.items=[],this.el.innerHTML="",this.activeIndex=null,this}up(e){return this.shown?this.moveActiveItem("prev",e):this}down(e){return this.shown?this.moveActiveItem("next",e):this}moveActiveItem(e,t){if(null!=this.activeIndex){const n="next"===e?this.getNextActiveIndex():this.getPrevActiveIndex();null!=n&&(this.activate(n),t.preventDefault())}return this}activate(e){return this.activeIndex!==e&&(null!=this.activeIndex&&this.items[this.activeIndex].deactivate(),this.activeIndex=e,this.items[e].activate()),this}isShown(){return this.shown}getActiveItem(){return null!=this.activeIndex?this.items[this.activeIndex]:null}setOffset(e){const n=document.documentElement;if(n){const r=this.el.offsetWidth;if(e.left){const t=this.option.dynamicWidth?n.scrollWidth:n.clientWidth;e.left+r>t&&(e.left=t-r),this.el.style.left=`${e.left}px`}else e.right&&(e.right-r<0&&(e.right=0),this.el.style.right=`${e.right}px`);let i=!1;const o=this.option.placement||t.DEFAULT_DROPDOWN_PLACEMENT;if("auto"===o){const t=this.items.length*e.lineHeight;i=null!=e.clientTop&&e.clientTop+t>n.clientHeight}"top"===o||i?(this.el.style.bottom=`${n.clientHeight-e.top+e.lineHeight}px`,this.el.style.top="auto"):(this.el.style.top=`${e.top}px`,this.el.style.bottom="auto")}return this}getNextActiveIndex(){if(null==this.activeIndex)throw new Error;return this.activeIndex<this.items.length-1?this.activeIndex+1:this.option.rotate?0:null}getPrevActiveIndex(){if(null==this.activeIndex)throw new Error;return 0!==this.activeIndex?this.activeIndex-1:this.option.rotate?this.items.length-1:null}renderItems(){const e=document.createDocumentFragment();for(const t of this.items)e.appendChild(t.el);return this.el.appendChild(e),this}setStrategyId(e){const t=e.getStrategyId();return t&&(this.el.dataset.strategy=t),this}renderEdge(e,t){const n=this.option[t],r=document.createElement("li");return r.className=`textcomplete-${t}`,r.innerHTML="function"==typeof n?n(e.map((e=>e.data))):n||"",this.el.appendChild(r),this}}t.Dropdown=o;class s{constructor(e,n,r,i){this.dropdown=e,this.index=n,this.searchResult=r,this.props=i,this.active=!1,this.onClick=e=>{e.preventDefault(),this.dropdown.select(this)},this.className=this.props.className||t.DEFAULT_DROPDOWN_ITEM_CLASS_NAME,this.activeClassName=this.props.activeClassName||t.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME;const o=document.createElement("li");o.className=this.active?this.activeClassName:this.className;const s=document.createElement("span");s.tabIndex=-1,s.innerHTML=this.searchResult.render(),o.appendChild(s),o.addEventListener("click",this.onClick),this.el=o}destroy(){var e;const t=this.el;return null===(e=t.parentNode)||void 0===e||e.removeChild(t),t.removeEventListener("click",this.onClick,!1),this}activate(){return this.active||(this.active=!0,this.el.className=this.activeClassName,this.dropdown.el.scrollTop=this.el.offsetTop),this}deactivate(){return this.active&&(this.active=!1,this.el.className=this.className),this}}},6e3:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(2615),t),i(n(4871),t),i(n(3271),t),i(n(3103),t),i(n(9099),t),i(n(8638),t),i(n(2665),t)},6628:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i}),n(4692);var r=n(5194);n(2877),r.default.select.classes.checkbox="form-check-input";const i=r.default},8357:e=>{"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}function v(e){return Array.isArray?Array.isArray(e):"[object Array]"===C(e)}function m(e){return"string"==typeof e}function g(e){return"number"==typeof e}function y(e){return"object"===r(e)}function _(e){return null!=e}function b(e){return!e.trim().length}function C(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var E=Object.prototype.hasOwnProperty,w=function(){function e(t){var n=this;i(this,e),this._keys=[],this._keyMap={};var r=0;t.forEach((function(e){var t=x(e);n._keys.push(t),n._keyMap[t.id]=t,r+=t.weight})),this._keys.forEach((function(e){e.weight/=r}))}return s(e,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),e}();function x(e){var t=null,n=null,r=null,i=1,o=null;if(m(e)||v(e))r=e,t=A(e),n=O(e);else{if(!E.call(e,"name"))throw new Error("Missing ".concat("name"," property in key"));var s=e.name;if(r=s,E.call(e,"weight")&&(i=e.weight)<=0)throw new Error(function(e){return"Property 'weight' in key '".concat(e,"' must be a positive integer")}(s));t=A(s),n=O(s),o=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:o}}function A(e){return v(e)?e:e.split(".")}function O(e){return v(e)?e.join("."):e}var k={useExtendedSearch:!1,getFn:function(e,t){var n=[],r=!1;return function e(t,i,o){if(_(t))if(i[o]){var s=t[i[o]];if(!_(s))return;if(o===i.length-1&&(m(s)||g(s)||function(e){return!0===e||!1===e||function(e){return y(e)&&null!==e}(e)&&"[object Boolean]"==C(e)}(s)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(s));else if(v(s)){r=!0;for(var a=0,c=s.length;a<c;a+=1)e(s[a],i,o+1)}else i.length&&e(s,i,o+1)}else n.push(t)}(e,m(t)?t.split("."):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},D=n(n(n(n({},{isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(e,t){return e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),k),S=/[^ ]+/g,L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getFn,r=void 0===n?D.getFn:n,o=t.fieldNormWeight,s=void 0===o?D.fieldNormWeight:o;i(this,e),this.norm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=new Map,r=Math.pow(10,t);return{get:function(t){var i=t.match(S).length;if(n.has(i))return n.get(i);var o=1/Math.pow(i,.5*e),s=parseFloat(Math.round(o*r)/r);return n.set(i,s),s},clear:function(){n.clear()}}}(s,3),this.getFn=r,this.isCreated=!1,this.setIndexRecords()}return s(e,[{key:"setSources",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=e}},{key:"setIndexRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=e}},{key:"setKeys",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=t,this._keysMap={},t.forEach((function(t,n){e._keysMap[t.id]=n}))}},{key:"create",value:function(){var e=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,m(this.docs[0])?this.docs.forEach((function(t,n){e._addString(t,n)})):this.docs.forEach((function(t,n){e._addObject(t,n)})),this.norm.clear())}},{key:"add",value:function(e){var t=this.size();m(e)?this._addString(e,t):this._addObject(e,t)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}},{key:"getValueForItemAtKeyId",value:function(e,t){return e[this._keysMap[t]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,t){if(_(e)&&!b(e)){var n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}}},{key:"_addObject",value:function(e,t){var n=this,r={i:t,$:{}};this.keys.forEach((function(t,i){var o=t.getFn?t.getFn(e):n.getFn(e,t.path);if(_(o))if(v(o)){for(var s=[],a=[{nestedArrIndex:-1,value:o}];a.length;){var c=a.pop(),u=c.nestedArrIndex,l=c.value;if(_(l))if(m(l)&&!b(l)){var h={v:l,i:u,n:n.norm.get(l)};s.push(h)}else v(l)&&l.forEach((function(e,t){a.push({nestedArrIndex:t,value:e})}))}r.$[i]=s}else if(m(o)&&!b(o)){var d={v:o,n:n.norm.get(o)};r.$[i]=d}})),this.records.push(r)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),e}();function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.getFn,i=void 0===r?D.getFn:r,o=n.fieldNormWeight,s=void 0===o?D.fieldNormWeight:o,a=new L({getFn:i,fieldNormWeight:s});return a.setKeys(e.map(x)),a.setSources(t),a.create(),a}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.errors,r=void 0===n?0:n,i=t.currentLocation,o=void 0===i?0:i,s=t.expectedLocation,a=void 0===s?0:s,c=t.distance,u=void 0===c?D.distance:c,l=t.ignoreLocation,h=void 0===l?D.ignoreLocation:l,d=r/e.length;if(h)return d;var f=Math.abs(a-o);return u?d+f/u:f?1:d}var F=32;function N(e){for(var t={},n=0,r=e.length;n<r;n+=1){var i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}var T=String.prototype.normalize?function(e){return e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,"")}:function(e){return e},q=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.location,s=void 0===o?D.location:o,a=r.threshold,c=void 0===a?D.threshold:a,u=r.distance,l=void 0===u?D.distance:u,h=r.includeMatches,d=void 0===h?D.includeMatches:h,f=r.findAllMatches,p=void 0===f?D.findAllMatches:f,v=r.minMatchCharLength,m=void 0===v?D.minMatchCharLength:v,g=r.isCaseSensitive,y=void 0===g?D.isCaseSensitive:g,_=r.ignoreDiacritics,b=void 0===_?D.ignoreDiacritics:_,C=r.ignoreLocation,E=void 0===C?D.ignoreLocation:C;if(i(this,e),this.options={location:s,threshold:c,distance:l,includeMatches:d,findAllMatches:p,minMatchCharLength:m,isCaseSensitive:y,ignoreDiacritics:b,ignoreLocation:E},t=y?t:t.toLowerCase(),t=b?T(t):t,this.pattern=t,this.chunks=[],this.pattern.length){var w=function(e,t){n.chunks.push({pattern:e,alphabet:N(e),startIndex:t})},x=this.pattern.length;if(x>F){for(var A=0,O=x%F,k=x-O;A<k;)w(this.pattern.substr(A,F),A),A+=F;if(O){var S=x-F;w(this.pattern.substr(S),S)}}else w(this.pattern,0)}}return s(e,[{key:"searchIn",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.ignoreDiacritics,i=t.includeMatches;if(e=n?e:e.toLowerCase(),e=r?T(e):e,this.pattern===e){var o={isMatch:!0,score:0};return i&&(o.indices=[[0,e.length-1]]),o}var s=this.options,a=s.location,c=s.distance,u=s.threshold,l=s.findAllMatches,h=s.minMatchCharLength,f=s.ignoreLocation,p=[],v=0,m=!1;this.chunks.forEach((function(t){var n=t.pattern,r=t.alphabet,o=t.startIndex,s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.location,o=void 0===i?D.location:i,s=r.distance,a=void 0===s?D.distance:s,c=r.threshold,u=void 0===c?D.threshold:c,l=r.findAllMatches,h=void 0===l?D.findAllMatches:l,d=r.minMatchCharLength,f=void 0===d?D.minMatchCharLength:d,p=r.includeMatches,v=void 0===p?D.includeMatches:p,m=r.ignoreLocation,g=void 0===m?D.ignoreLocation:m;if(t.length>F)throw new Error("Pattern length exceeds max of ".concat(F,"."));for(var y,_=t.length,b=e.length,C=Math.max(0,Math.min(o,b)),E=u,w=C,x=f>1||v,A=x?Array(b):[];(y=e.indexOf(t,w))>-1;){var O=I(t,{currentLocation:y,expectedLocation:C,distance:a,ignoreLocation:g});if(E=Math.min(O,E),w=y+_,x)for(var k=0;k<_;)A[y+k]=1,k+=1}w=-1;for(var S=[],L=1,M=_+b,N=1<<_-1,T=0;T<_;T+=1){for(var q=0,B=M;q<B;)I(t,{errors:T,currentLocation:C+B,expectedLocation:C,distance:a,ignoreLocation:g})<=E?q=B:M=B,B=Math.floor((M-q)/2+q);M=B;var P=Math.max(1,C-B+1),j=h?b:Math.min(C+B,b)+_,R=Array(j+2);R[j+1]=(1<<T)-1;for(var z=j;z>=P;z-=1){var $=z-1,W=n[e.charAt($)];if(x&&(A[$]=+!!W),R[z]=(R[z+1]<<1|1)&W,T&&(R[z]|=(S[z+1]|S[z])<<1|1|S[z+1]),R[z]&N&&(L=I(t,{errors:T,currentLocation:$,expectedLocation:C,distance:a,ignoreLocation:g}))<=E){if(E=L,(w=$)<=C)break;P=Math.max(1,2*C-w)}}if(I(t,{errors:T+1,currentLocation:C,expectedLocation:C,distance:a,ignoreLocation:g})>E)break;S=R}var U={isMatch:w>=0,score:Math.max(.001,L)};if(x){var H=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.minMatchCharLength,n=[],r=-1,i=-1,o=0,s=e.length;o<s;o+=1){var a=e[o];a&&-1===r?r=o:a||-1===r||((i=o-1)-r+1>=t&&n.push([r,i]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}(A,f);H.length?v&&(U.indices=H):U.isMatch=!1}return U}(e,n,r,{location:a+o,distance:c,threshold:u,findAllMatches:l,minMatchCharLength:h,includeMatches:i,ignoreLocation:f}),g=s.isMatch,y=s.score,_=s.indices;g&&(m=!0),v+=y,g&&_&&(p=[].concat(d(p),d(_)))}));var g={isMatch:m,score:m?v/this.chunks.length:1};return m&&i&&(g.indices=p),g}}]),e}(),B=function(){function e(t){i(this,e),this.pattern=t}return s(e,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return P(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return P(e,this.singleRegex)}}]),e}();function P(e,t){var n=e.match(t);return n?n[1]:null}var j=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),n}(B),R=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),n}(B),z=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),n}(B),$=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),n}(B),W=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),n}(B),U=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){var t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),n}(B),H=function(e){c(n,e);var t=h(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.location,a=void 0===s?D.location:s,c=o.threshold,u=void 0===c?D.threshold:c,l=o.distance,h=void 0===l?D.distance:l,d=o.includeMatches,f=void 0===d?D.includeMatches:d,p=o.findAllMatches,v=void 0===p?D.findAllMatches:p,m=o.minMatchCharLength,g=void 0===m?D.minMatchCharLength:m,y=o.isCaseSensitive,_=void 0===y?D.isCaseSensitive:y,b=o.ignoreDiacritics,C=void 0===b?D.ignoreDiacritics:b,E=o.ignoreLocation,w=void 0===E?D.ignoreLocation:E;return i(this,n),(r=t.call(this,e))._bitapSearch=new q(e,{location:a,threshold:u,distance:h,includeMatches:f,findAllMatches:v,minMatchCharLength:g,isCaseSensitive:_,ignoreDiacritics:C,ignoreLocation:w}),r}return s(n,[{key:"search",value:function(e){return this._bitapSearch.searchIn(e)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),n}(B),Q=function(e){c(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return s(n,[{key:"search",value:function(e){for(var t,n=0,r=[],i=this.pattern.length;(t=e.indexOf(this.pattern,n))>-1;)n=t+i,r.push([t,n-1]);var o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),n}(B),X=[j,Q,z,$,U,W,R,H],J=X.length,V=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,K=new Set([H.type,Q.type]),G=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.isCaseSensitive,o=void 0===r?D.isCaseSensitive:r,s=n.ignoreDiacritics,a=void 0===s?D.ignoreDiacritics:s,c=n.includeMatches,u=void 0===c?D.includeMatches:c,l=n.minMatchCharLength,h=void 0===l?D.minMatchCharLength:l,d=n.ignoreLocation,f=void 0===d?D.ignoreLocation:d,p=n.findAllMatches,v=void 0===p?D.findAllMatches:p,m=n.location,g=void 0===m?D.location:m,y=n.threshold,_=void 0===y?D.threshold:y,b=n.distance,C=void 0===b?D.distance:b;i(this,e),this.query=null,this.options={isCaseSensitive:o,ignoreDiacritics:a,includeMatches:u,minMatchCharLength:h,findAllMatches:v,ignoreLocation:f,location:g,threshold:_,distance:C},t=o?t:t.toLowerCase(),t=a?T(t):t,this.pattern=t,this.query=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.split("|").map((function(e){for(var n=e.trim().split(V).filter((function(e){return e&&!!e.trim()})),r=[],i=0,o=n.length;i<o;i+=1){for(var s=n[i],a=!1,c=-1;!a&&++c<J;){var u=X[c],l=u.isMultiMatch(s);l&&(r.push(new u(l,t)),a=!0)}if(!a)for(c=-1;++c<J;){var h=X[c],d=h.isSingleMatch(s);if(d){r.push(new h(d,t));break}}}return r}))}(this.pattern,this.options)}return s(e,[{key:"searchIn",value:function(e){var t=this.query;if(!t)return{isMatch:!1,score:1};var n=this.options,r=n.includeMatches,i=n.isCaseSensitive,o=n.ignoreDiacritics;e=i?e:e.toLowerCase(),e=o?T(e):e;for(var s=0,a=[],c=0,u=0,l=t.length;u<l;u+=1){var h=t[u];a.length=0,s=0;for(var f=0,p=h.length;f<p;f+=1){var v=h[f],m=v.search(e),g=m.isMatch,y=m.indices,_=m.score;if(!g){c=0,s=0,a.length=0;break}if(s+=1,c+=_,r){var b=v.constructor.type;K.has(b)?a=[].concat(d(a),d(y)):a.push(y)}}if(s){var C={isMatch:!0,score:c/s};return r&&(C.indices=a),C}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,t){return t.useExtendedSearch}}]),e}(),Y=[];function Z(e,t){for(var n=0,r=Y.length;n<r;n+=1){var i=Y[n];if(i.condition(e,t))return new i(e,t)}return new q(e,t)}var ee="$and",te="$path",ne=function(e){return!(!e[ee]&&!e.$or)},re=function(e){return a({},ee,Object.keys(e).map((function(t){return a({},t,e[t])})))};function ie(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).auto,r=void 0===n||n;return ne(e)||(e=re(e)),function e(n){var i=Object.keys(n),o=function(e){return!!e[te]}(n);if(!o&&i.length>1&&!ne(n))return e(re(n));if(function(e){return!v(e)&&y(e)&&!ne(e)}(n)){var s=o?n[te]:i[0],a=o?n.$val:n[s];if(!m(a))throw new Error(function(e){return"Invalid value for key ".concat(e)}(s));var c={keyId:O(s),pattern:a};return r&&(c.searcher=Z(a,t)),c}var u={children:[],operator:i[0]};return i.forEach((function(t){var r=n[t];v(r)&&r.forEach((function(t){u.children.push(e(t))}))})),u}(e)}function oe(e,t){var n=e.matches;t.matches=[],_(n)&&n.forEach((function(e){if(_(e.indices)&&e.indices.length){var n={indices:e.indices,value:e.value};e.key&&(n.key=e.key.src),e.idx>-1&&(n.refIndex=e.idx),t.matches.push(n)}}))}function se(e,t){t.score=e.score}var ae=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;i(this,e),this.options=n(n({},D),r),this.options.useExtendedSearch,this._keyStore=new w(this.options.keys),this.setCollection(t,o)}return s(e,[{key:"setCollection",value:function(e,t){if(this._docs=e,t&&!(t instanceof L))throw new Error("Incorrect 'index' type");this._myIndex=t||M(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(e){_(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},t=[],n=0,r=this._docs.length;n<r;n+=1){var i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,r-=1,t.push(i))}return t}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).limit,n=void 0===t?-1:t,r=this.options,i=r.includeMatches,o=r.includeScore,s=r.shouldSort,a=r.sortFn,c=r.ignoreFieldNorm,u=m(e)?m(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(e,t){var n=t.ignoreFieldNorm,r=void 0===n?D.ignoreFieldNorm:n;e.forEach((function(e){var t=1;e.matches.forEach((function(e){var n=e.key,i=e.norm,o=e.score,s=n?n.weight:null;t*=Math.pow(0===o&&s?Number.EPSILON:o,(s||1)*(r?1:i))})),e.score=t}))}(u,{ignoreFieldNorm:c}),s&&u.sort(a),g(n)&&n>-1&&(u=u.slice(0,n)),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.includeMatches,i=void 0===r?D.includeMatches:r,o=n.includeScore,s=void 0===o?D.includeScore:o,a=[];return i&&a.push(oe),s&&a.push(se),e.map((function(e){var n=e.idx,r={item:t[n],refIndex:n};return a.length&&a.forEach((function(t){t(e,r)})),r}))}(u,this._docs,{includeMatches:i,includeScore:o})}},{key:"_searchStringList",value:function(e){var t=Z(e,this.options),n=this._myIndex.records,r=[];return n.forEach((function(e){var n=e.v,i=e.i,o=e.n;if(_(n)){var s=t.searchIn(n),a=s.isMatch,c=s.score,u=s.indices;a&&r.push({item:n,idx:i,matches:[{score:c,value:n,norm:o,indices:u}]})}})),r}},{key:"_searchLogical",value:function(e){var t=this,n=ie(e,this.options),r=function e(n,r,i){if(!n.children){var o=n.keyId,s=n.searcher,a=t._findMatches({key:t._keyStore.get(o),value:t._myIndex.getValueForItemAtKeyId(r,o),searcher:s});return a&&a.length?[{idx:i,item:r,matches:a}]:[]}for(var c=[],u=0,l=n.children.length;u<l;u+=1){var h=e(n.children[u],r,i);if(h.length)c.push.apply(c,d(h));else if(n.operator===ee)return[]}return c},i=this._myIndex.records,o={},s=[];return i.forEach((function(e){var t=e.$,i=e.i;if(_(t)){var a=r(n,t,i);a.length&&(o[i]||(o[i]={idx:i,item:t,matches:[]},s.push(o[i])),a.forEach((function(e){var t,n=e.matches;(t=o[i].matches).push.apply(t,d(n))})))}})),s}},{key:"_searchObjectList",value:function(e){var t=this,n=Z(e,this.options),r=this._myIndex,i=r.keys,o=r.records,s=[];return o.forEach((function(e){var r=e.$,o=e.i;if(_(r)){var a=[];i.forEach((function(e,i){a.push.apply(a,d(t._findMatches({key:e,value:r[i],searcher:n})))})),a.length&&s.push({idx:o,item:r,matches:a})}})),s}},{key:"_findMatches",value:function(e){var t=e.key,n=e.value,r=e.searcher;if(!_(n))return[];var i=[];if(v(n))n.forEach((function(e){var n=e.v,o=e.i,s=e.n;if(_(n)){var a=r.searchIn(n),c=a.isMatch,u=a.score,l=a.indices;c&&i.push({score:u,key:t,value:n,idx:o,norm:s,indices:l})}}));else{var o=n.v,s=n.n,a=r.searchIn(o),c=a.isMatch,u=a.score,l=a.indices;c&&i.push({score:u,key:t,value:o,norm:s,indices:l})}return i}}]),e}();ae.version="7.1.0",ae.createIndex=M,ae.parseIndex=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getFn,r=void 0===n?D.getFn:n,i=t.fieldNormWeight,o=void 0===i?D.fieldNormWeight:i,s=e.keys,a=e.records,c=new L({getFn:r,fieldNormWeight:o});return c.setKeys(s),c.setIndexRecords(a),c},ae.config=D,ae.parseQuery=ie,function(){Y.push.apply(Y,arguments)}(G);var ce=ae;e.exports=ce},8456:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TextareaEditor=void 0;const i=n(2531),o=r(n(9418)),s=n(6e3),a=n(9326);class c extends s.Editor{constructor(e){super(),this.el=e,this.onInput=()=>{this.emitChangeEvent()},this.onKeydown=e=>{const t=this.getCode(e);let n;"UP"===t||"DOWN"===t?n=this.emitMoveEvent(t):"ENTER"===t?n=this.emitEnterEvent():"ESC"===t&&(n=this.emitEscEvent()),n&&n.defaultPrevented&&e.preventDefault()},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(e){const t=this.getBeforeCursor();if(null!=t){const n=e.replace(t,this.getAfterCursor());this.el.focus(),Array.isArray(n)&&((0,i.update)(this.el,n[0],n[1]),this.el&&this.el.dispatchEvent((0,s.createCustomEvent)("input")))}}getCursorOffset(){const e=(0,a.calculateElementOffset)(this.el),t=this.getElScroll(),n=this.getCursorPosition(),r=(0,a.getLineHeightPx)(this.el),i=e.top-t.top+n.top+r,o=e.left-t.left+n.left,s=this.el.getBoundingClientRect().top;return"rtl"!==this.el.dir?{top:i,left:o,lineHeight:r,clientTop:s}:{top:i,right:document.documentElement?document.documentElement.clientWidth-o:0,lineHeight:r,clientTop:s}}getBeforeCursor(){return this.el.selectionStart!==this.el.selectionEnd?null:this.el.value.substring(0,this.el.selectionEnd)}getAfterCursor(){return this.el.value.substring(this.el.selectionEnd)}getElScroll(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}getCursorPosition(){return(0,o.default)(this.el,this.el.selectionEnd)}startListening(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}stopListening(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}t.TextareaEditor=c},8638:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Textcomplete=void 0;const r=n(228),i=n(4871),o=n(2615),s=["show","shown","render","rendered","selected","hidden","hide"];class a extends r.EventEmitter{constructor(e,t,n){super(),this.editor=e,this.isQueryInFlight=!1,this.nextPendingQuery=null,this.handleHit=({searchResults:e})=>{e.length?this.dropdown.render(e,this.editor.getCursorOffset()):this.dropdown.hide(),this.isQueryInFlight=!1,null!==this.nextPendingQuery&&this.trigger(this.nextPendingQuery)},this.handleMove=e=>{"UP"===e.detail.code?this.dropdown.up(e):this.dropdown.down(e)},this.handleEnter=e=>{const t=this.dropdown.getActiveItem();t?(this.dropdown.select(t),e.preventDefault()):this.dropdown.hide()},this.handleEsc=e=>{this.dropdown.isShown()&&(this.dropdown.hide(),e.preventDefault())},this.handleChange=e=>{null!=e.detail.beforeCursor?this.trigger(e.detail.beforeCursor):this.dropdown.hide()},this.handleSelect=e=>{this.emit("select",e),e.defaultPrevented||this.editor.applySearchResult(e.detail.searchResult)},this.handleResize=()=>{this.dropdown.isShown()&&this.dropdown.setOffset(this.editor.getCursorOffset())},this.completer=new o.Completer(t),this.dropdown=i.Dropdown.create((null==n?void 0:n.dropdown)||{}),this.startListening()}destroy(e=!0){return this.completer.destroy(),this.dropdown.destroy(),e&&this.editor.destroy(),this.stopListening(),this}isShown(){return this.dropdown.isShown()}hide(){return this.dropdown.hide(),this}trigger(e){return this.isQueryInFlight?this.nextPendingQuery=e:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(e)),this}startListening(){var e;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect);for(const e of s)this.dropdown.on(e,(t=>this.emit(e,t)));this.completer.on("hit",this.handleHit),null===(e=this.dropdown.el.ownerDocument.defaultView)||void 0===e||e.addEventListener("resize",this.handleResize)}stopListening(){var e;null===(e=this.dropdown.el.ownerDocument.defaultView)||void 0===e||e.removeEventListener("resize",this.handleResize),this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}t.Textcomplete=a},8675:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineHeightPx=void 0;const n="0".charCodeAt(0),r="9".charCodeAt(0),i=e=>n<=e&&e<=r;t.getLineHeightPx=e=>{const t=getComputedStyle(e),n=t.lineHeight;if(i(n.charCodeAt(0))){const e=parseFloat(n);return i(n.charCodeAt(n.length-1))?e*parseFloat(t.fontSize):e}return o(e.nodeName,t)};const o=(e,t)=>{const n=document.body;if(!n)return 0;const r=document.createElement(e);r.innerHTML="&nbsp;",Object.assign(r.style,{fontSize:t.fontSize,fontFamily:t.fontFamily,padding:"0"}),n.appendChild(r),r instanceof HTMLTextAreaElement&&(r.rows=1);const i=r.offsetHeight;return n.removeChild(r),i}},9099:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strategy=t.DEFAULT_INDEX=void 0;const r=n(3103);t.DEFAULT_INDEX=1,t.Strategy=class{constructor(e){this.props=e,this.cache={}}destroy(){return this.cache={},this}replace(e){return this.props.replace(e)}execute(e,n){var i;const o=this.matchWithContext(e);if(!o)return!1;const s=o[null!==(i=this.props.index)&&void 0!==i?i:t.DEFAULT_INDEX];return this.search(s,(e=>{n(e.map((e=>new r.SearchResult(e,s,this))))}),o),!0}renderTemplate(e,t){if(this.props.template)return this.props.template(e,t);if("string"==typeof e)return e;throw new Error(`Unexpected render data type: ${typeof e}. Please implement template parameter by yourself`)}getId(){return this.props.id||null}match(e){return"function"==typeof this.props.match?this.props.match(e):e.match(this.props.match)}search(e,t,n){this.props.cache?this.searchWithCach(e,t,n):this.props.search(e,t,n)}matchWithContext(e){const t=this.context(e);return!1===t?null:this.match(!0===t?e:t)}context(e){return!this.props.context||this.props.context(e)}searchWithCach(e,t,n){null!=this.cache[e]?t(this.cache[e]):this.props.search(e,(n=>{this.cache[e]=n,t(n)}),n)}}},9326:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1251),t),i(n(8675),t),i(n(1960),t)},9418:e=>{!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n="undefined"!=typeof window,r=n&&null!=window.mozInnerScreenX;function i(e,i,o){if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var s=o&&o.debug||!1;if(s){var a=document.querySelector("#input-textarea-caret-position-mirror-div");a&&a.parentNode.removeChild(a)}var c=document.createElement("div");c.id="input-textarea-caret-position-mirror-div",document.body.appendChild(c);var u=c.style,l=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,h="INPUT"===e.nodeName;u.whiteSpace="pre-wrap",h||(u.wordWrap="break-word"),u.position="absolute",s||(u.visibility="hidden"),t.forEach((function(e){h&&"lineHeight"===e?u.lineHeight=l.height:u[e]=l[e]})),r?e.scrollHeight>parseInt(l.height)&&(u.overflowY="scroll"):u.overflow="hidden",c.textContent=e.value.substring(0,i),h&&(c.textContent=c.textContent.replace(/\s/g,""));var d=document.createElement("span");d.textContent=e.value.substring(i)||".",c.appendChild(d);var f={top:d.offsetTop+parseInt(l.borderTopWidth),left:d.offsetLeft+parseInt(l.borderLeftWidth),height:parseInt(l.lineHeight)};return s?d.style.backgroundColor="#aaa":document.body.removeChild(c),f}void 0!==e.exports?e.exports=i:n&&(window.getCaretCoordinates=i)}()},9787:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextareaEditor=void 0;var r=n(8456);Object.defineProperty(t,"TextareaEditor",{enumerable:!0,get:function(){return r.TextareaEditor}})}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={id:e,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,i,o)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,i,o]=e[l],a=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(l--,1);var u=i();void 0!==u&&(t=u)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,i,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=299,(()=>{var e={299:0,751:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[s,a,c]=n,u=0;if(s.some((t=>0!==e[t]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(c)var l=c(r)}for(t&&t(n);u<s.length;u++)o=s[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(l)},n=self.webpackChunkhanfor=self.webpackChunkhanfor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0;var i=r.O(void 0,[223],(()=>r(1521)));i=r.O(i)})();