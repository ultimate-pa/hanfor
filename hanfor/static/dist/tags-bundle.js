(()=>{var e,a={1541:(e,a,n)=>{var t=n(4692);n(7081),n(9875),n(5194),n(97),n(7776),n(4371),n(5219),n(9145),n(1453),n(8131);const o=n(9692),{SearchNode:r}=n(1108),{Modal:c}=n(9875);n(6719);const{sendTelemetry:l}=n(6719),i=[":AND:",":OR:",":NOT:",":COL_INDEX_00:",":COL_INDEX_01:",":COL_INDEX_02:"],s=sessionStorage.getItem("tagsSearchString");function d(e){sessionStorage.setItem("tagsSearchString",e),search_tree=r.fromQuery(e)}t(document).ajaxStart((function(){t.LoadingOverlay("show")})),t(document).ajaxStop((function(){t.LoadingOverlay("hide")})),t(document).ready((function(){!function(){let e=t("#tag-modal");e.on("shown.bs.modal",(function(e){o.update(t("#tag-description"))})),e[0].addEventListener("hide.bs.modal",(function(e){!function(e){!0===t("#tag-modal").data("unsaved_changes")&&!0!==confirm("You have unsaved changes, do you really want to close?")&&e.preventDefault()}(e)})),t("#tag-name").change((function(){t("#tag-modal").data("unsaved_changes",!0)})),t("#tag-color").change((function(){t("#tag-modal").data("unsaved_changes",!0)})),t("#tag-internal").change((function(){t("#tag-modal").data("unsaved_changes",!0)})),t("#tag-description").change((function(){t("#tag-modal").data("unsaved_changes",!0)}))}();const e=t("#search_bar"),a=t("#tags-table"),n=a.DataTable({paging:!0,stateSave:!0,pageLength:50,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',ajax:{url:"../api/tags/",dataSrc:""},deferRender:!0,columns:u,initComplete:function(){e.val(s),d(e.val().trim()),t.fn.dataTable.ext.search.push((function(e,a,n){return function(e){return search_tree.evaluate(e,[!0,!0,!0])}(a)})),this.api().draw()}});new t.fn.dataTable.ColReorder(n,{}),e.keypress((function(a){13===a.which&&(d(e.val().trim()),n.draw())})),new Awesomplete(e[0],{filter:function(e,a){let n=!1;return(a.split(":").length-1)%2==1&&(n=Awesomplete.FILTER_CONTAINS(e,a.match(/[^:]*$/)[0])),n},item:function(e,a){return Awesomplete.ITEM(e,a.match(/(:)([\S]*$)/)[2])},replace:function(e){const a=this.input.value.match(/(.*)(:(?!.*:).*$)/)[1];this.input.value=a+e},list:i,minChars:1,autoFirst:!0}),a.find("tbody").on("click","a.modal-opener",(function(e){e.preventDefault();let a=n.row(t(e.target).parent()).data(),o=n.row(t(e.target).parent()).index();c.getOrCreateInstance(t("#tag-modal")).show(),t("#modal-associated-row-index").val(o),t("#tag-name-old").val(a.name),t("#occurences").val(a.used_by),t("#tag-modal-title").html("Tag: "+a.name),t("#tag-name").val(a.name),t("#tag-color").val(a.color),t("#tag-description").val(a.description),t("#tag-internal").prop("checked",a.internal)})),t("#save-tag-modal").click((function(){!function(){let e=t("#tag-name-old").val(),a=t("#tag-name").val(),n=t("#occurences").val().split(","),o=t("#tag-color").val(),r=t("#tag-description").val(),c=t("#tag-internal").prop("checked");t.ajax({type:"PATCH",url:`../api/tags/${e}`,contentType:"application/json",data:JSON.stringify({name_new:a,occurrences:n,color:o,description:r,internal:c})}).done((function(e){t("#tag-modal").data("unsaved_changes",!1),location.reload()})).fail((function(e,a,n){alert(n+"\n\n"+e.responseText)}))}()})),n.on("click",".internal-checkbox",(function(e){e.preventDefault();let a=e.currentTarget,o=n.row(a.parentNode).data();t.ajax({type:"POST",url:"../api/tags/update",data:{name:o.name,name_old:o.name,occurences:o.used_by,color:o.color,description:o.description,internal:a.checked},success:function(e){!1!==e.success?(a.checked=e.data.internal,o.internal=e.data.internal):alert(e.errormsg)}})})),t(".delete-tag").bootstrapConfirmButton({onConfirm:function(){!function(){const e=t("#tag-name").val(),a=t("#occurences").val().split(",");t.ajax({type:"DELETE",url:`../api/tags/${e}`,contentType:"application/json",data:JSON.stringify({occurrences:a})}).done((function(e){t("#tag-modal").data("unsaved_changes",!1),location.reload()})).fail((function(e,a,n){alert(n+"\n\n"+e.responseText)}))}()}}),o(t("#tag-description")),t(".clear-all-filters").click((function(){e.val("").effect("highlight",{color:"green"},500),d(e.val().trim()),n.draw()})),t("#add-standard-tags").click((function(){t.ajax({type:"POST",url:"../api/tags/add_standard"}).done((function(e){location.reload()})).fail((function(e,a,n){alert(n+"\n\n"+e.responseText)}))}))}));const u=[{data:"name",render:function(e,a,n,t){return`<a class="modal-opener" href="#">${e}</a>`}},{data:"description",render:function(e,a,n,t){return`<div class="white-space-pre">${e}</div>`}},{data:"used_by",render:function(e,a,n,o){let r="";if(t(e).each((function(e,a){a.length>0&&(r+=`<span class="badge bg-info"><a href="${base_url}?command=search&col=2&q=%5C%22${a}%5C%22" target="_blank" class="link-light">${a}</a></span> `)})),e.length>1&&r.length>0){const e=`?command=search&col=5&q=%5C%22${n.name}%5C%22`;r+=`<span class="badge bg-info"><a href="${base_url}${e}" target="_blank" class="link-light">Show all</a></span> `}return r}},{data:"internal",render:function(e,a,n,t){return`<input class="form-check-input internal-checkbox" type="checkbox" ${e?"checked":""}>`}},{data:"used_by",visible:!1,searchable:!1,render:function(e,a,n,t){return e.filter((e=>e&&""!==e)).join(", ")}}]}},n={};function t(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={id:e,exports:{}};return a[e].call(r.exports,r,r.exports,t),r.exports}t.m=a,e=[],t.O=(a,n,o,r)=>{if(!n){var c=1/0;for(d=0;d<e.length;d++){for(var[n,o,r]=e[d],l=!0,i=0;i<n.length;i++)(!1&r||c>=r)&&Object.keys(t.O).every((e=>t.O[e](n[i])))?n.splice(i--,1):(l=!1,r<c&&(c=r));if(l){e.splice(d--,1);var s=o();void 0!==s&&(a=s)}}return a}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]},t.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},t.d=(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.j=192,(()=>{var e={192:0};t.O.j=a=>0===e[a];var a=(a,n)=>{var o,r,[c,l,i]=n,s=0;if(c.some((a=>0!==e[a]))){for(o in l)t.o(l,o)&&(t.m[o]=l[o]);if(i)var d=i(t)}for(a&&a(n);s<c.length;s++)r=c[s],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(d)},n=self.webpackChunkhanfor=self.webpackChunkhanfor||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))})(),t.nc=void 0;var o=t.O(void 0,[223],(()=>t(1541)));o=t.O(o)})();