(()=>{var e,t={6052:(e,t,a)=>{var n=a(9755);a(1388);const{Modal:r}=a(4712);a(3333),a(6099),a(2993),a(3889),a(944),a(7312),a(2106),a(9570),a(7175);let o=a(5759),l=["CONST","ENUM_INT","ENUM_REAL"],i=[":AND:",":OR:",":NOT:",":COL_INDEX_01:",":COL_INDEX_02:",":COL_INDEX_03:",":COL_INDEX_04:"],s=sessionStorage.getItem("var_search_string"),c=[];const{SearchNode:u}=a(3024);let _,m=[!0,!0,!0,!0,!0],v=JSON.parse(search_query);function d(){s=n("#search_bar").val().trim(),sessionStorage.setItem("var_search_string",s),_=u.fromQuery(s)}function p(e,t=!1){let a=n("body");a.LoadingOverlay("show");let r=n("#multi-change-type-input").val().trim(),o=[];e.rows({selected:!0}).every((function(){let e=this.data();o.push(e.name)})),n.post("api/var/multi_update",{change_type:r,selected_vars:JSON.stringify(o),del:t},(function(e){a.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):location.reload()}))}function h(){n(".requirement_var_group").each((function(){n(this).hide()})),n(".formalization_card").each((function(){const e=n(this).attr("title"),t=n("#requirement_scope"+e).val(),a=n("#requirement_pattern"+e).val();let r=n("#requirement_var_group_p"+e),o=n("#requirement_var_group_q"+e),l=n("#requirement_var_group_r"+e),i=n("#requirement_var_group_s"+e),s=n("#requirement_var_group_t"+e),c=n("#requirement_var_group_u"+e),u=n("#requirement_var_group_v"+e);switch(t){case"BEFORE":case"AFTER":r.show();break;case"BETWEEN":case"AFTER_UNTIL":r.show(),o.show()}Object.keys(_PATTERNS[a].env).forEach((function(e){switch(e){case"R":l.show();break;case"S":i.show();break;case"T":s.show();break;case"U":c.show();break;case"V":u.show()}}))}))}function f(){n(".formalization_card").each((function(){const e=n(this).attr("title");let t="";const a=n("#requirement_scope"+e).find("option:selected").text().replace(/\s\s+/g," "),r=n("#requirement_pattern"+e).find("option:selected").text().replace(/\s\s+/g," ");"None"!==a&&"None"!==r&&(t=a+", "+r+".");let o=n("#formalization_var_p"+e).val(),l=n("#formalization_var_q"+e).val(),i=n("#formalization_var_r"+e).val(),s=n("#formalization_var_s"+e).val(),u=n("#formalization_var_t"+e).val(),_=n("#formalization_var_u"+e).val(),m=n("#formalization_var_v"+e).val();o.length>0&&(t=t.replace(/{P}/g,o)),l.length>0&&(t=t.replace(/{Q}/g,l)),i.length>0&&(t=t.replace(/{R}/g,i)),s.length>0&&(t=t.replace(/{S}/g,s)),u.length>0&&(t=t.replace(/{T}/g,u)),_.length>0&&(t=t.replace(/{U}/g,_)),m.length>0&&(t=t.replace(/{V}/g,m)),n("#current_formalization_textarea"+e).val(t);let v=n("#formalization_heading"+e);if(e in c)for(let t=0;t<c[e].length;t++)n("#formalization_var_"+c[e][t]+e).addClass("type-error"),v.addClass("type-error-head");else v.removeClass("type-error-head")})),n("#variable_constraint_updated").val("true")}function g(){n(".formalization_selector").change((function(){h(),f()})),n(".reqirement-variable, .req_var_type").change((function(){f()})),n(".delete_formalization").bootstrapConfirmButton({onConfirm:function(){!function(e){let t=n(".modal-content");t.LoadingOverlay("show");const a=n("#variable_name").val();n.post("api/var/del_constraint",{name:a,constraint_id:e},(function(e){t.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):n("#formalization_accordion").html(e.html)})).done((function(){h(),f(),g()}))}(n(this).attr("name"))}})}function b(e){!0===e?n("#variable_value_form_group").hide():n("#variable_value_form_group").show()}function y(e=!1){!0===e?n("#variable_belongs_to_form_group").hide():n("#variable_belongs_to_form_group").show()}function w(e=!1){!0===e?n(".enum-controls").hide():n(".enum-controls").show()}function O(e){let t=n("#variables_table").DataTable().row(e).data(),a=n(".modal-content");b(!0),w(!0),y(!0),r.getOrCreateInstance(document.getElementById("variable_modal")).show(),n("#modal_associated_row_index").val(e),n("#variable_name_old").val(t.name),n("#variable_type_old").val(t.type),n("#occurences").val(t.used_by),n("#variable_modal_title").html("Variable: "+t.name),n("#variable_name").val(t.name);let o=n("#variable_type"),i=n("#variable_value"),s=n("#variable_value_old"),u=n("#belongs_to_enum"),_=n("#belongs_to_enum_old"),m=n("#enumerators");var v;o.val(t.type),i.val(""),s.val(""),u.val(""),_.val(""),m.html(""),"CONST"!==t.type&&"ENUMERATOR_INT"!==t.type&&"ENUMERATOR_REAL"!==t.type||(b(),i.val(t.const_val),s.val(t.const_val)),"ENUMERATOR_INT"!==t.type&&"ENUMERATOR_REAL"!==t.type||(y(),u.val(t.belongs_to_enum),_.val(t.belongs_to_enum)),"ENUM_REAL"!==t.type&&"ENUM_INT"!==t.type||(w(),v=t.name,n.post("api/var/get_enumerators",{name:v},(function(e){!1===e.success?alert(e.errormsg):n.each(e.enumerators,(function(e,t){N(t[0].substr(v.length+1),t[1])}))})).done((function(){h(),f(),g()}))),o.autocomplete({minLength:0,source:l}).on("focus",(function(){n(this).keydown()})),function(e){n.post("api/var/get_constraints_html",{name:e},(function(e){!1===e.success?alert(e.errormsg):(c=e.type_inference_errors,n("#formalization_accordion").html(e.html))})).done((function(){h(),f(),g()}))}(t.name),a.LoadingOverlay("hide")}function N(e,t){const a=`\n        <div class="input-group enumerator-input">\n            <span class="input-group-prepend input-group-text">Name</span>\n            <input class="form-control enum_name_input" type="text" value="${e}">\n            <span class="input-group-prepend input-group-text">Value</span>\n            <input class="form-control enum_value_input" type="number" step="any" value="${t}">\n            <buttton type="button" class="btn btn-danger input-group-append del_enum" data-name="${e}">Delete</buttton>\n        </div>`;n("#enumerators").append(a)}function E(){const e=n("#new_variable_type").val();let t=n("#new_variable_const_input");"CONST"===e?t.show():t.hide()}n(document).ready((function(){let e=n("#variables_table").DataTable({paging:!0,stateSave:!0,select:{style:"os",selector:"td:first-child"},pageLength:50,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',ajax:"api/var/gets",deferRender:!0,columns:[{orderable:!1,className:"select-checkbox",targets:[0],data:null,defaultContent:""},{data:"name",targets:[1],render:function(e){return'<a class="modal-opener" href="#">'+e+"</span></br>"}},{data:"type",targets:[2],render:function(e,t,a){return null!==e&&l.indexOf(e)<=-1&&l.push(e),null!==e&&"CONST"===e&&(e=e+" ("+a.const_val+")"),e}},{data:"constraints",targets:[3],render:function(e){let t="";return n(e).each((function(e,a){a.length>0&&(t+=a)})),t}},{data:"tags",targets:[4],render:function(e){let t="";return n(e).each((function(e,a){a.length>0&&(t+='<span class="badge bg-danger">'+a+"</span>")})),t}},{data:"used_by",targets:[5],render:function(e,t,a){let r="",o="";return n(e).each((function(e,t){if(t.length>0&&!function(e){let t=null,a=/^(Constraint_)(.*)(_[0-9]+$)/gm.exec(e);return null!==a&&(t=a[2]),t}(t)){let e="?command=search&col=2&q=%5C%22"+t+"%5C%22";r+='<span class="badge bg-info"><a href="./'+e+'" target="_blank" class="link-light">'+t+"</a></span> ",o.length>0?o+="%3AOR%3A%3ACOL_INDEX_02%3A%5C%22"+t+"%5C%22":o+=e}})),r.length<1?r+='<span class="badge bg-warning">unused</span></br>':e.length>1&&(r+='<span class="badge bg-info"><a href="./'+o+'" target="_blank" class="link-light">Show all</a></span> '),r}},{data:"script_results",targets:[6],render:function(e){return e}},{data:"used_by",targets:[7],visible:!1,searchable:!1,render:function(e){let t="";return n(e).each((function(e,a){a.length>0&&(t.length>1&&(t+=", "),t+=a)})),t}}],infoCallback:function(e,t,a,r,o){let l=this.api().page.info();n("#clear-all-filters-text").html("Showing "+o+"/"+l.recordsTotal+". Clear all.");let i="Showing "+t+" to "+a+" of "+o+" entries";return i+=" (filtered from "+l.recordsTotal+" total entries).",i},initComplete:function(){n("#search_bar").val(s),n(".variable_link").click((function(e){e.preventDefault(),O(function(e){let t=n("#variables_table").DataTable(),a=-1;return t.row((function(t,n){n.name===e&&(a=t)})),a}(n(this).data("name")))})),o.process_url_query(v),d(),n.fn.dataTable.ext.search.push((function(e,t){return function(e){return _.evaluate(e,m)}(t)})),this.api().draw()}});e.column(6).visible(!1),e.column(7).visible(!1),new n.fn.dataTable.ColReorder(e,{});let t=n("#search_bar");new Awesomplete(t[0],{filter:function(e,t){let a=!1;return(t.split(":").length-1)%2==1&&(a=Awesomplete.FILTER_CONTAINS(e,t.match(/[^:]*$/)[0])),a},item:function(e,t){return Awesomplete.ITEM(e,t.match(/(:)([\S]*$)/)[2])},replace:function(e){const t=this.input.value.match(/(.*)(:(?!.*:).*$)/)[1];this.input.value=t+e},list:i,minChars:1,autoFirst:!0}),t.keypress((function(t){13===t.which&&(d(),e.draw())})),n("#variables_table  tbody").on("click","a.modal-opener",(function(t){t.preventDefault(),O(e.row(n(t.target).parent()).index())})),n("#save_variable_modal").click((function(){!function(e){let t=n(".modal-content");t.LoadingOverlay("show");const a=n("#variable_name").val(),r=n("#variable_name_old").val(),o=n("#variable_type").val(),i=n("#variable_type_old").val(),s=parseInt(n("#modal_associated_row_index").val()),c=n("#occurences").val(),u=n("#variable_value").val(),_=n("#variable_value_old").val(),m=n("#variable_constraint_updated").val(),v=n("#belongs_to_enum").val(),d=n("#belongs_to_enum_old").val();let p={};n(".formalization_card").each((function(){let e={};e.id=n(this).attr("title"),n(this).find("select").each((function(){n(this).hasClass("scope_selector")&&(e.scope=n(this).val()),n(this).hasClass("pattern_selector")&&(e.pattern=n(this).val())})),e.expression_mapping={},n(this).find("textarea.reqirement-variable").each((function(){""!==n(this).attr("title")&&(e.expression_mapping[n(this).attr("title")]=n(this).val())})),p[e.id]=e})),null!==o&&l.indexOf(o)<=-1&&l.push(o);let h=[];"ENUM_INT"!==o&&"ENUM_REAL"!==o||n(".enumerator-input").each((function(){let e=n(this).find(".enum_name_input").val(),t=n(this).find(".enum_value_input").val();h.push([e,t])})),n.post("api/var/update",{name:a,name_old:r,type:o,const_val:u,const_val_old:_,type_old:i,occurrences:c,constraints:JSON.stringify(p),updated_constraints:m,enumerators:JSON.stringify(h),belongs_to_enum:v,belongs_to_enum_old:d},(function(a){t.LoadingOverlay("hide",!0),!1===a.success?alert(a.errormsg):a.rebuild_table?location.reload():(e.row(s).data(a.data).draw(),n("#variable_modal").modal("hide"))}))}(e)})),n("#variable_type").on("keyup change autocompleteclose",(function(){"CONST"===n(this).val()?b():b(!0),"ENUMERATOR_INT"===n(this).val()||"ENUMERATOR_REAL"===n(this).val()?(y(),b()):y(!0),"ENUM_INT"===n(this).val()||"ENUM_REAL"===n(this).val()?w():w(!0)})),n(".import_link").on("click",(function(){!function(e,t){let a=n("#variable_import_modal");n("#variable_import_sess_name").val(e),n("#variable_import_sess_revision").val(t),n("#variable_import_modal_title").html("Import from Session: "+e+" at: "+t),r.getOrCreateInstance(a).show(),a.LoadingOverlay("show"),n.post("api/var/var_import_info",{sess_name:e,sess_revision:t},(function(e){a.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):(n("#import_tot_number").html("Total:\t"+e.tot_vars+" Variables."),n("#import_new_number").html("New:\t"+e.new_vars+" Variables."))}))}(n(this).attr("data-name"),n(this).attr("data-revision"))})),n("#start_variable_import_session").click((function(){!function(){let e=n("#variable_import_modal"),t=n("#variable_import_sess_name").val(),a=n("#variable_import_sess_revision").val();e.LoadingOverlay("show"),n.post("api/var/start_import_session",{sess_name:t,sess_revision:a},(function(t){e.LoadingOverlay("hide",!0),!1===t.success?alert(t.errormsg):window.location.href=base_url+"variable_import/"+t.session_id}))}()})),n(".select-all-button").on("click",(function(){n(this).hasClass("btn-secondary")?e.rows({page:"current"}).select():e.rows({page:"current"}).deselect(),n(".select-all-button").toggleClass("btn-secondary btn-primary")})),e.on("user-select",(function(){let e=n(".select-all-button");e.removeClass("btn-primary"),e.addClass("btn-secondary ")})),n("#multi-change-type-input").autocomplete({minLength:0,source:l,delay:100}).on("focus",(function(){n(this).keydown()})).val(""),n(".apply-multi-edit").click((function(){p(e)})),n("body").on("click",".delete_button",(function(){const t=n(this);void 0===t.data("html")?(t.outerWidth(t.outerWidth()).data("html",t.html()).html("Do it!"),setTimeout((function(){t.html(t.data("html")).removeData("html").outerWidth("")}),2e3)):(t.html(t.data("html")).removeData("html").outerWidth(""),p(e,!0))})),n("#add_constraint").click((function(){!function(){let e=n(".modal-content");e.LoadingOverlay("show");const t=n("#variable_name").val();n.post("api/var/new_constraint",{name:t},(function(t){e.LoadingOverlay("hide",!0),!1===t.success?alert(t.errormsg):n("#formalization_accordion").html(t.html)})).done((function(){h(),f(),g()}))}()})),n("#save_new_variable_modal").click((function(){!function(){const e=n("#new_variable_name").val(),t=n("#new_variable_type").val(),a=n("#new_variable_const_value").val();n.post("api/var/add_new_variable",{name:e,type:t,value:a},(function(e){!1===e.success?alert(e.errormsg):location.reload()}))}()})),n("#add_enumerator").click((function(){N("")})),n("#enumerators").on("click",".del_enum",(function(){const e=n(this).attr("data-name"),t=n("#variable_name_old").val();let a=n(this).parent(".enumerator-input");0===e.length?a.remove():function(e,t,a){let r=n("#variable_modal");r.LoadingOverlay("show"),n.post("api/var/del_var",{name:e+"_"+t},(function(e){r.LoadingOverlay("hide",!0),!1===e.success?alert(e.errormsg):a.remove()}))}(t,e,a)})).on("paste",".enum_name_input",(function(e){let t=e.originalEvent.clipboardData.getData("text");if(function(e){const t=e.match(/[^\r\n]+/g);if(t.length<=0)return!1;for(const e of t){const t=e.match(/[^\t]+/g);if(2!==t.length)return!1;if(isNaN(t[1]))return!1}return!0}(t)){console.log("has smart input form");const a=function(e){const t=e.match(/[^\r\n]+/g);let a=[];for(const e of t){const t=e.match(/[^\t]+/g);a.push([t[0],t[1]])}return a}(t);console.log(a);for(const e of a)N(e[0],e[1]);e.preventDefault()}})),n("#generate_req").click((function(){n("#generate_req_form").submit()})),n(".clear-all-filters").click((function(){n("#search_bar").val("").effect("highlight",{color:"green"},500),d(),e.draw()})),n("#variable_new_vaiable_modal")[0].addEventListener("show.bs.modal",(function(){E()})),n("#new_variable_type").on("change",(function(){E()}))}))}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var o=a[e]={id:e,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,a,r,o)=>{if(!a){var l=1/0;for(u=0;u<e.length;u++){for(var[a,r,o]=e[u],i=!0,s=0;s<a.length;s++)(!1&o||l>=o)&&Object.keys(n.O).every((e=>n.O[e](a[s])))?a.splice(s--,1):(i=!1,o<l&&(l=o));if(i){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,r,o]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=565,(()=>{var e={565:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,o,[l,i,s]=a,c=0;if(l.some((t=>0!==e[t]))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(s)var u=s(n)}for(t&&t(a);c<l.length;c++)o=l[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},a=self.webpackChunkhanfor=self.webpackChunkhanfor||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),n.nc=void 0;var r=n.O(void 0,[351],(()=>n(6052)));r=n.O(r)})();