<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
            <link rel="canonical" href="https://ultimate-pa.github.io/hanfor/usage/workflow.html">
        
            <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Workflow
            - Hanfor Docs</title>
        <link rel="stylesheet"
              href="../css/stupid_fonts.css"/>

        <link rel="stylesheet" href="../css/theme.css"/>
        <link rel="stylesheet" href="../css/theme_extra.css"/>
        <link rel="stylesheet" href="../css/lightbox.min.css"/>
            <link rel="stylesheet" href="../css/github.min.css"/>
            <link href="../stylesheets/extra.css" rel="stylesheet"/>
        
            <script>
                // Current page data
                var mkdocs_page_name = "Workflow";
                var mkdocs_page_input_path = "usage\\workflow.md";
                var mkdocs_page_url = "/hanfor/usage/workflow.html";
            </script>
        
        <script src="../js/jquery-2.1.1.min.js" defer></script>
        <script src="../js/modernizr-2.8.3.min.js" defer></script>
            <script src="../js/highlight.min.js"></script>
            <script src="../js/python.min.js"></script>
            <script src="../js/bash.min.js"></script>
            <script>hljs.initHighlightingOnLoad();</script>
        <script src="../js/lightbox.min.js" defer></script> 
        
</head>

<body class="wy-body-for-nav" role="document">

<div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">
                    <a href="../index.html" class="icon icon-home"> Hanfor Docs</a>
                    <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                            <p class="caption"><span class="caption-text">Introduction</span></p>
                            <ul>
                                    <li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">What is Hanfor?</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#requirement-formalization">Requirement Formalization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#requirement-check">Requirement Check</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#test-generation">Test Generation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#tool-support">Tool support</a>
    </li>
    </ul>
                                    </li>
                            </ul>
                            <p class="caption"><span class="caption-text">Installation</span></p>
                            <ul>
                                    <li class="toctree-l1"><a class="reference internal" href="../installation/preliminaries.html">Preliminaries</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../installation/preliminaries.html#install-hanfor">Install Hanfor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../installation/preliminaries.html#install-reqanalyzer">Install ReqAnalyzer</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="../installation/configuration.html">Configuration</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../installation/configuration.html#hanfor">Hanfor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../installation/configuration.html#reqanalyzer">ReqAnalyzer</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="../installation/deployment.html">Deployment</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../installation/deployment.html#how-it-works">How it works</a>
    </li>
    </ul>
                                    </li>
                            </ul>
                            <p class="caption"><span class="caption-text">Usage</span></p>
                            <ul class="current">
                                    <li class="toctree-l1"><a class="reference internal" href="api_queries.html">API queries</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="api_queries.html#show-stored-queries">Show stored queries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="api_queries.html#adding-new-queries">Adding new queries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="api_queries.html#deleting-queries">Deleting queries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="api_queries.html#query-syntax">Query syntax</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="faq.html#change-description-or-a-field-text-in-requirements-table">Change description or a field text in requirements table.</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="requirements.html#search-in-requirements-table">Search in requirements table</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="requirements.html#mass-edit-requirements">Mass edit requirements</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1 current"><a class="reference internal current" href="workflow.html">Workflow</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#example-input">Example input</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#fire-up-hanfor">Fire up Hanfor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#formalization">Formalization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exporting-the-formalized-requirements">Exporting the formalized requirements.</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#analysis-using-ultimate">Analysis using Ultimate.</a>
    </li>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="patterns.html">Patterns</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bnddelayedresponsepatternut">BndDelayedResponsePatternUT</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndentryconditionpattern">BndEntryConditionPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndexistencepattern">BndExistencePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndinvariancepattern">BndInvariancePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndreccurrencepattern">BndReccurrencePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndresponsepatterntt">BndResponsePatternTT</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndresponsepatterntu">BndResponsePatternTU</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndresponsepatternut">BndResponsePatternUT</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#bndtriggeredentryconditionpattern">BndTriggeredEntryConditionPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#instabspattern">InstAbsPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#invariantpattern">InvariantPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#maxdurationpattern">MaxDurationPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#mindurationpattern">MinDurationPattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#precedencechain12pattern">PrecedenceChain12Pattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#precedencechain21pattern">PrecedenceChain21Pattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#precedencepattern">PrecedencePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#responsechain21pattern">ResponseChain21Pattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#responsepattern">ResponsePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#togglepattern">TogglePattern</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#togglepatterndelayed">TogglePatternDelayed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="patterns.html#universalitypattern">UniversalityPattern</a>
    </li>
    </ul>
                                    </li>
                            </ul>
                            <p class="caption"><span class="caption-text">Contribute</span></p>
                            <ul>
                                    <li class="toctree-l1"><a class="reference internal" href="../contribute/to_hanfor.html">Hanfor</a>
    <ul>
    </ul>
                                    </li>
                                    <li class="toctree-l1"><a class="reference internal" href="../contribute/to_docs.html">To docs</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../contribute/to_docs.html#0-optional-setup-a-virtual-environment">0. (Optional) setup a virtual environment</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../contribute/to_docs.html#1-install-mkdocs-and-all-dependencies">1. Install MkDocs and all dependencies.</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../contribute/to_docs.html#2-serve-this-documentation-locally-to-track-your-changes">2. Serve this Documentation locally to track your changes.</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../contribute/to_docs.html#3-publish-your-changes-to-the-staging-directory">3. Publish your changes to the staging directory.</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../contribute/to_docs.html#4-publish-your-changes-to-the-live-directory">4. Publish your changes to the live directory</a>
    </li>
    </ul>
                                    </li>
                            </ul>
            </div>
        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        
        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="../index.html">Hanfor Docs</a>
        </nav>

        
        <div class="wy-nav-content">
            <div class="rst-content">
                <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>Usage &raquo;</li>
        
      
    
    <li>Workflow</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ultimate-pa/hanfor/edit/master/documentation/docs/usage/workflow.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
                <div role="main">
                    <div class="section">
                        
                            <h1 id="workflow">Workflow<a class="headerlink" href="#workflow" title="Permanent link"> #</a></h1>
<p>This example and everything that belongs to it is located in <code>example_input</code>.</p>
<h2 id="example-input">Example input<a class="headerlink" href="#example-input" title="Permanent link"> #</a></h2>
<p>The CSV file <code>example_intput/example_input.csv</code> contains requirements:</p>
<pre><code class="bash">ID,Description,Type
META1,This is an example for some requirements,meta
META2,Next we define some requirements,meta
REQ1,var1 is always greater than 5,requirement
REQ2,var2 is always smaller than 10,requirement
REQ3,constraint1 always holds,requirement
REQ4,constraint2 always holds,requirement
REQ5,var1 is always smaller than 5,requirement
REQ6,constraint1 and constraint2 never hold at the same time,requirement
REQ7,if var3 = True then var4 := 1,requirement
REQ8,if var3 = True then var4 := 0,requirement
</code></pre>

<p>In this case every row consists of the fields <code>ID</code>, <code>Description</code>, and <code>Type</code>.</p>
<ul>
<li><code>ID</code> is a unique identifier, </li>
<li><code>Description</code> is the description ,</li>
<li><code>Type</code>, is a type, in this example <code>meta</code> or <code>requirement</code>, where rows with type <code>meta</code> contain some meta-information
and rows with type <code>requirement</code> contain actual requirements of the module you want to formalize.</li>
</ul>
<h2 id="fire-up-hanfor">Fire up Hanfor<a class="headerlink" href="#fire-up-hanfor" title="Permanent link"> #</a></h2>
<ol>
<li>Configure Hanfor as explained in <a href="/installation/configuration">Configuration</a></li>
<li>Start Hanfor: </li>
</ol>
<pre><code class="bash">cd hanfor
python3 app.py -c ../example_input/example_input.csv awesome_tag_by_bree
</code></pre>

<ul>
<li><code>-c example_input.csv</code> specifies the csv input file we pass.</li>
<li><code>example_tag</code> is some meaningful tag you want to give this session.
If you start hanfor later with the same tag, you'll start exactly this session.</li>
</ul>
<p>Currently the startup of Hanfor is interactive and looks like this:</p>
<pre><code class="shell">(venv) bree@titan:~/repos/hanfor/hanfor$ python3 app.py -c ../example_input/example_input.csv awesome_tag_by_bree
2019-10-10 13:55:17,845: [DEBUG]: Enabled logging.
2019-10-10 13:55:17,858: [INFO]: Hanfor starts creating a revision.
2019-10-10 13:55:17,858: [INFO]: No revisions for `awesome_tag_by_bree`. Creating initial revision.
2019-10-10 13:55:17,858: [INFO]: Load Input : example/example_input.csv
2019-10-10 13:55:17,862: [INFO]: Could not guess .csv dialect, assuming defaults
Select ID header
╔Choices═════════════╗
║ 0    ║ Description ║
║ -&gt; 1 ║ ID          ║
║ 2    ║ Type        ║
╚══════╩═════════════╝
[Choice or Enter for  -&gt; default]&gt; 1
Select requirements description header
╔Choices══════════╗
║ 0 ║ Description ║
║ 1 ║ ID          ║
║ 2 ║ Type        ║
╚═══╩═════════════╝
[Choice or Enter for  -&gt; default]&gt; 0
Select formalization header
╔Choices════════════════════╗
║ 0 ║ Description           ║
║ 1 ║ ID                    ║
║ 2 ║ Type                  ║
║ 3 ║ Add new Formalization ║
╚═══╩═══════════════════════╝
[Choice or Enter for  -&gt; default]&gt; 3
Select type header.
╔Choices══════════╗
║ 0 ║ Description ║
║ 1 ║ ID          ║
║ 2 ║ Type        ║
╚═══╩═════════════╝
[Choice or Enter for  -&gt; default]&gt; 2
</code></pre>

<p>Alternatively you can directly pass the header definition, using <code>--header</code>: </p>
<pre><code>python3 app.py -c example_input/example_input.csv --header='{&quot;csv_id_header&quot;: &quot;ID&quot;, &quot;csv_desc_header&quot;: &quot;Description&quot;, &quot;csv_formal_header&quot;: &quot;Hanfor_Formalization&quot;, &quot;csv_type_header&quot; : &quot;Type&quot;}' awesome_tag
</code></pre>

<p>you can now reach Hanfor by visiting <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a></p>
<figure><a data-lightbox="all_images" data-title="Hanfor requirement overview" href="../img/hanfor01.png"><img alt="Hanfor requirement overview" src="../img/hanfor01.png" title="This is how Hanfor looks like after you started it" /></a><figcaption>Hanfor requirement overview</figcaption>
</figure>
<h2 id="preprocessing">Preprocessing<a class="headerlink" href="#preprocessing" title="Permanent link"> #</a></h2>
<p>By default, all rows now have the status <strong>Todo</strong>. 
It might be the case that you want to change this for a certain set of rows to another status.</p>
<p>In this example we want to set every row of type <code>meta</code> to the status <strong>Done</strong>. </p>
<p>To accomplish this we use the <a href="/usage/requirements/#search-in-requirements-table">Search Query Language</a>. </p>
<ol>
<li>In Hanfor, search  <code>:COL_INDEX_04:meta</code>. This will search for rows which match "meta" in the 4. coloumn (Type). You should now only see the rows of type <code>meta</code>.</li>
<li>Select all rows by clicking  <strong>All</strong>.</li>
<li>Click <strong>Edit selected</strong> and select <strong>Done</strong> in the field <strong>Set status</strong>.</li>
<li>Finally, click <strong>Apply changes to selected requirements</strong></li>
</ol>
<h2 id="formalization">Formalization<a class="headerlink" href="#formalization" title="Permanent link"> #</a></h2>
<p>Order your requirement overview by <strong>Pos</strong> by clicking on the table column.</p>
<h3 id="req1">REQ1<a class="headerlink" href="#req1" title="Permanent link"> #</a></h3>
<p>To formalize this requirement, we click on the ID <strong>REQ1</strong> to open then formalization-modal:</p>
<figure><a data-lightbox="all_images" data-title="Formalization modal" href="../img/hanfor02.png"><img alt="Formalization modal" src="../img/hanfor02.png" title="This is how a formalization modal looks like" /></a><figcaption>Formalization modal</figcaption>
</figure>
<ol>
<li>Click on <strong>+</strong> to add a new formalization and then on <strong>..(click to open)</strong></li>
<li>We now have to select a <em>Scope</em> and a <em>Pattern</em>.
<em> The scope is <strong>Globally</strong>, because the requirement states that "var1 is <strong>always</strong> greater than 5".
</em> The pattern is <strong>it is always the case that {R} holds</strong>.
<em> For <strong>{R}</strong> we insert the condition: <code>var1 &gt; 5</code> 
</em> Set the status to <strong>Review</strong> and then press <strong>save changes</strong>.
If you save a requirement, Hanfor will automatically create the used variables and derive their type.
You can examine and even alter them in the section <strong>Variables</strong>, for the case that Hanfor did not derive a variable-type correctly.</li>
</ol>
<figure><a data-lightbox="all_images" data-title="Definition of Scope and Pattern" href="../img/hanfor_req1_formalization.png"><img alt="Definition of Scope and Pattern" src="../img/hanfor_req1_formalization.png" title="This is how we formalize REQ1" /></a><figcaption>Definition of Scope and Pattern</figcaption>
</figure>
<p>The same procedure can be applied to REQ2 - REQ6</p>
<h3 id="req7-and-req8">REQ7 and REQ8<a class="headerlink" href="#req7-and-req8" title="Permanent link"> #</a></h3>
<p>REQ7 and REQ8 are different.
Consider REQ7: <code>if var3 = True then var4 := 0</code>.</p>
<ul>
<li>The scope is still <strong>Globally</strong> </li>
<li>The pattern is <strong>it is always the case that if "{R}" holds, then "{S}" holds after at most "{T}" time units</strong>, because in a realtime-system a variable assignment does not happen instantly, there can be delays.</li>
<li>For <strong>{R}</strong> we insert <code>var3</code>, because the variable type is boolean.</li>
<li>For <strong>{S}</strong> insert <code>var4 == 0</code>,</li>
<li>For <strong>{T}</strong> we need a certain amount of time units, for example 50. We do not want to hardcode values, 
we introduce a new variable and insert <code>MAX_TIME</code>.</li>
</ul>
<p>We end up with the following: </p>
<pre><code>Globally, it is always the case that if &quot;var3&quot; holds, then &quot;var4 == 0&quot; holds after at most &quot;MAX_TIME&quot; time units.
</code></pre>

<p>Save the formalization. </p>
<p>You will now recognize that Hanfor automatically added a new <em>Tag</em> <strong>Type_inference_error</strong> to your freshly
formalized requirement. To fix that, to go the <strong>Variables</strong> section and open the <code>MAX_TIME</code> variable.
You see that Hanfor derived the type <code>bool</code>, but we actually want it to be of type <code>CONST</code> as the variable represents time units. Change the type and
also assign a value, for example <code>50</code>.</p>
<figure><a data-lightbox="all_images" data-title="Example for the MAX_TIME variable" href="../img/hanfor_var_maxtime.png"><img alt="Example for the MAX_TIME variable" src="../img/hanfor_var_maxtime.png" title="This is how you should edit the MAX_TIME variable" /></a><figcaption>Example for the <code>MAX_TIME</code> variable</figcaption>
</figure>
<p>For REQ8 you should have: </p>
<pre><code>Globally, it is always the case that if &quot;var3&quot; holds, then &quot;var4 == 1&quot; holds after at most &quot;MAX_TIME&quot; time units.
</code></pre>

<h2 id="exporting-the-formalized-requirements">Exporting the formalized requirements.<a class="headerlink" href="#exporting-the-formalized-requirements" title="Permanent link"> #</a></h2>
<p>Once you are done with all requirements, it is time to analyze them using a tool like Ultimate (TODO:ref to git).</p>
<h3 id="preparing-the-export">Preparing the export.<a class="headerlink" href="#preparing-the-export" title="Permanent link"> #</a></h3>
<p>You might want to filter out some rows, for example, all of type <code>meta</code> or all that have a certain tag.
Again, use the <a href="/usage/requirements/#search-in-requirements-table">Search Query Language</a> to select only the requirements you want.
For example, if we only rows of type <code>requirement</code> which are not on status <strong>Todo</strong> we search:</p>
<pre><code>:COL_INDEX_04:requirement:AND::COL_INDEX_06::NOT:Todo
</code></pre>

<h3 id="export">Export<a class="headerlink" href="#export" title="Permanent link"> #</a></h3>
<p>To export requirements, press <strong>Tools</strong>, then choose either <code>.req</code> or <code>.csv</code>.
If you want to analyze the requirements using Ultimate, choose <strong>Generate .req file from (filtered) requirements table</strong>
and then save it.</p>
<p>You should end up with the following:</p>
<pre><code class="plain">CONST MAX_TIME IS 50.0

Input constraint1 IS bool
Input constraint2 IS bool
Input var1 IS int
Input var2 IS int
Input var3 IS bool
Input var4 IS int


REQ1_0: Globally, it is always the case that &quot;var1 &gt; 5&quot; holds
REQ2_0: Globally, it is always the case that &quot;var2 &lt; 10&quot; holds
REQ3_0: Globally, it is always the case that &quot;constraint1&quot; holds
REQ4_0: Globally, it is always the case that &quot;constraint2&quot; holds
REQ5_0: Globally, it is always the case that &quot;var1 &lt; 5&quot; holds
REQ6_0: Globally, it is never the case that &quot;constraint1 &amp;&amp; constraint2 &quot; holds
REQ7_0: Globally, it is always the case that if &quot;var3&quot; holds, then &quot;var4 == 1&quot; holds after at most &quot;MAX_TIME&quot; time units
REQ8_0: Globally, it is always the case that if &quot;var3&quot; holds, then &quot;var4 == 0&quot; holds after at most &quot;MAX_TIME &quot; time units
</code></pre>

<h2 id="analysis-using-ultimate">Analysis using Ultimate.<a class="headerlink" href="#analysis-using-ultimate" title="Permanent link"> #</a></h2>
<h3 id="get-ultimate">Get Ultimate<a class="headerlink" href="#get-ultimate" title="Permanent link"> #</a></h3>
<p>First of all you need <a href="https://github.com/ultimate-pa/ultimate">Ultimate</a></p>
<ol>
<li>Install <code>Java JDK (1.8)</code> and <code>Maven (&gt;3.0)</code></li>
<li>Clone the repository: <code>git clone https://github.com/ultimate-pa/ultimate</code>.</li>
<li>Navigate to the release scripts <code>cd ultimate/releaseScripts/default</code></li>
<li>Generate a fresh binary <code>./makeFresh.sh</code></li>
</ol>
<p>You have now successfully forged binaries, which are located in <code>UReqCheck-linux</code>.</p>
<h3 id="scripts-to-perform-the-complete-analysis">Scripts to perform the complete analysis.<a class="headerlink" href="#scripts-to-perform-the-complete-analysis" title="Permanent link"> #</a></h3>
<p>We wrote a script, which perform a complete anaylsis, including the extraction of relevant stuff.
The script is located in <code>/path/to/ultimate/releaseScripts/default/UReqCheck-linux</code>.</p>
<ul>
<li>You have to configure <code>run_complete_analysis.sh</code>, which is used to run the complete analysis.
The script takes several arguments:</li>
</ul>
<pre><code>run_complete_analysis.sh &lt;req_file&gt; &lt;req_repo_folder&gt; &lt;req_folder&gt; [&lt;rt_inconsistency_range&gt; &lt;timeout_per_assertion&gt;]
</code></pre>

<p>Where:
<em> <code>req_file</code> is the Requirements file you generated using Hanfor.
</em> <code>req_repo_folder</code> is the path to the repository, which contains the requirements-folder
<em> <code>req_folder</code> is the path to the requirements-folder
</em> <code>rt_inconsistency_range</code> (default: 2) is the amount of requirements which are checked together for RT-inconsistency. 
Careful with this parameter, it will blow up the amount of checks really fast.
* <code>timeout_per_assertion</code> (default: 900) The time how long a singles assertion is checked.</p>
<h3 id="use-ultimate">Use Ultimate<a class="headerlink" href="#use-ultimate" title="Permanent link"> #</a></h3>
<p>We now simply execute the <code>run_complete_analysis.sh</code> script.</p>
<pre><code class="bash">$ cd /path/to/ultimate/releaseScripts/default/UReqCheck-linux
$ ./run_complete_analysis.sh path/to/repo/example_input/example_input.req path/to/repo/example_input path/to/repo/example_input
</code></pre>

<p>This will fire up Ultimate and run an analysis. The analysis checks for rt-inconsistency and vacuity and logs are be generated: </p>
<ul>
<li><code>hanfor/example/example_input.req.log</code></li>
<li><code>hanfor/example/example_input.req.testgen.log</code></li>
<li><code>hanfor/example/logs/example_input/example_input.req.relevant.log</code></li>
<li><code>hanfor/example/logs/example_input/example_input.req.testgen.log</code></li>
</ul>
<h3 id="evaluate">Evaluate<a class="headerlink" href="#evaluate" title="Permanent link"> #</a></h3>
<p>In <code>hanfor/example/example_input.req.log</code> we can see that Ultimate reports: </p>
<pre><code> --- Results ---
 * Results from de.uni_freiburg.informatik.ultimate.pea2boogie:
  - RequirementInconsistentErrorResult: Requirements set is inconsistent.
    Requirements set is inconsistent. Some invariants are already infeasible. Responsible requirements: REQ6_0, REQ3_0, REQ4_0
</code></pre>

<p>Now, if we investigate REQ3, REQ4 and REQ6:</p>
<pre><code>REQ3_0: Globally, it is always the case that &quot;constraint1&quot; holds
REQ4_0: Globally, it is always the case that &quot;constraint2&quot; holds
REQ6_0: Globally, it is never the case that &quot;constraint1 &amp;&amp; constraint2 &quot; holds
</code></pre>

<p>We directly see what the problem is: On one hand, our invariants demand that <code>constraint1</code> and <code>constraint2</code> always holds,
but on the other hand there is another invariant which demands that <code>constraint1</code> and <code>constraint2</code> never hold at the same time.
Think about this as:</p>
<pre><code>constraint1 &amp;&amp; constraint2 &amp;&amp; ((constraint1 &amp;&amp; !constraint2) || (!constraint1 &amp;&amp; constraint2))
</code></pre>

<p>this is clearly unsatisfiable.</p>
<h3 id="alter-your-requirements">Alter your requirements<a class="headerlink" href="#alter-your-requirements" title="Permanent link"> #</a></h3>
<p>We now found an inconsistency in our requirements, that has to be fixed. 
Let's assume you review your requirements and you recognize <code>REQ4</code> was defined wrong in the csv,
where <code>REQ4,constraint2 always holds,requirement</code> should be <code>REQ4,constraint2 never holds,requirement</code>.
While reading over the requirements, you also recognize that <code>REQ1</code> and <code>REQ5</code> collide and you find out that <code>REQ5</code> shall be deleted.</p>
<p>When we apply this changes, we end up with the following changes: </p>
<ul>
<li>alter <code>REQ4,constraint2 always holds,requirement</code> to <code>REQ4,constraint2 never holds,requirement</code></li>
<li>remove <code>REQ5</code></li>
</ul>
<p>and our csv file now looks as follows: </p>
<pre><code class="bash">ID,Description,Type
META1,This is an example for some requirements,meta
META2,Next we define some requirements,meta
REQ1,var1 is always greater than 5,requirement
REQ2,var2 is always smaller than 10,requirement
REQ3,constraint1 always holds,requirement
REQ4,constraint2 never holds,requirement
REQ6,constraint1 and constraint2 never hold at the same time,requirement
REQ7,if var3 = True then var4 = 0,requirement
REQ8,if var3 = True then var4 = 1,requirement
</code></pre>

<h3 id="time-for-a-new-revision">Time for a new revision.<a class="headerlink" href="#time-for-a-new-revision" title="Permanent link"> #</a></h3>
<p>We altered our requirements, we now need to create a new revision in Hanfor and change our formalizations.
Execute: </p>
<pre><code>$ cd hanfor
$ python3 app.py -r -c example/example_input.csv example_tag
</code></pre>

<ul>
<li>
<p>Hanfor will then ask: <strong>"Which revision should I use as a base?"</strong>,
we choose <code>revision_0</code> (as it is the only one, usually you want your latest revision).</p>
</li>
<li>
<p>Then, Hanfor asks <strong>Should I use the csv header mapping from base revision?</strong>,
as we did not change the csv header, we just keep the current one.</p>
</li>
</ul>
<p>A quick recap what happens when creating a revision:
<em> New requirements get the tag <code>revision_0_to_revision_1_new_requirement</code>
</em> Changed requirements get the tag <code>revision_0_to_revision_1_data_changed</code> and <code>revision_0_to_revision_1_description_changed</code>
* Requirements where the formalization migrated to the new revision get the tag <code>revision_0_to_revision_1_migrated_formalized</code></p>
<p>We now have to alter the requirements which have changed, that's only <code>REQ4</code>. 
Open the formalization of <code>REQ4</code> and correct it to <code>Globally, it is never the case that "constraint2" holds</code>.</p>
<h3 id="ultimate-analysis-2">Ultimate Analysis #2<a class="headerlink" href="#ultimate-analysis-2" title="Permanent link"> #</a></h3>
<ol>
<li>Export your requirements as before with the name <code>example_input_revision1.req</code></li>
<li>Run Ultimate on the new requirements file.</li>
</ol>
<p>You can now examine the log created in <code>hanfor/example/logs/example_input/example_input.req.relevant.log</code>,
which contains the following:</p>
<pre><code>- ReqCheckFailResult [Line: -1]: Requirements REQ8_0, REQ7_0 are rt-inconsistent
</code></pre>

<p>A <code>ReqCheckFailResult</code> usually implies that something is broken, 
Ultimate found that requirements <code>REQ7</code> and <code>REQ8</code> are rt-inconsistent, let's analyze this result:</p>
<pre><code>REQ7,if var3 = True then var4 = 0,requirement
REQ8,if var3 = True then var4 = 1,requirement
</code></pre>

<p>These two requirements collide, because they assign different values to <code>var4</code> when <code>var3</code> holds.
This is especially bad in a realtime system, because it can happen that <code>var4 == 0</code> holds after a certain amount of time, 
and <code>var4 == 1</code> holds at a later point of time or vice versa. Why is this bad? - because it can cause unexpected behaviour when a change propagates through the system.</p>
<h3 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link"> #</a></h3>
<p>You are now able to:</p>
<ol>
<li>Setup hanfor, </li>
<li>Formalize requirements, </li>
<li>Filter requirements, </li>
<li>Export them to a .req file</li>
<li>Run Ultimate on a .req file</li>
<li>Interpret the results of Ultimate</li>
<li>Create new revisions in hanfor to fix mistakes in requirements.</li>
</ol>
                        
                    </div>
                </div>
                    <footer>
  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a custom theme</a>.
</footer>
                
            </div>
        </div>

    </section>

</div>

<div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ultimate-pa/hanfor/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
        <script src="../search/main.js" defer></script>
    <script type="text/javascript" defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>
