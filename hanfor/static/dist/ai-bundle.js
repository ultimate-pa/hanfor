(()=>{var t,e={1245:(t,e,n)=>{var a=n(4692);n(7081),n(9875),n(5194),n(97),n(7776),n(5219),n(9145),n(1453),a(document).ready((function(){let t;function e(){a.ajax({type:"GET",url:"/api/ai/get/current_data",contentType:"application/json"}).done((function(e){t=e,function(){if(t.cluster_status){a("#cluster-status").text(t.cluster_status.status||"N/A");const e=t.cluster_status.processed||0,n=t.cluster_status.total||0;a("#cluster-availability").text(`${e} / ${n}`)}else a("#cluster-status").text("N/A"),a("#cluster-availability").text(0);t.ai_status?(a("#ai-running-count").text(t.ai_status.running||0),a("#ai-queue-count").text(t.ai_status.queued||0)):(a("#ai-running-count").text(0),a("#ai-queue-count").text(0));const e=t.cluster_status.processed,n=t.cluster_status.total,o=t.cluster_status.status;a("#progress-status").text(`Status: ${o}`),a("#progress-bar").css("width",e/n*100+"%"),a("#progress-bar").attr("aria-valuenow",e),a("#progress-bar").text(`${e}/${n}`),null!==t.ai_status.response&&a("#ai-response").text(t.ai_status.response),null!==t.ai_status.query&&a("#ai-query").text(t.ai_status.query),function(t){const e=a("#cluster-table tbody"),n=a("#cluster-table");a.fn.dataTable.isDataTable(n)&&n.DataTable().clear().destroy(),e.empty(),Array.isArray(t)&&0!==t.length?(t.sort(((t,e)=>r(t).localeCompare(r(e)))),t.forEach((t=>{if(!Array.isArray(t))return void console.error("Invalid cluster structure:",t);t.sort(((t,e)=>t.localeCompare(e)));const n=`Cluster ${t[0]}`,a=function(t){return t.map((t=>`<span class="badge bg-info">\n                <a href="${base_url}?command=search&col=2&q=%5C%22${t}%5C%22" target="_blank" class="link-light">${t}</a>\n            </span>`)).join(" ")}(t),o=t.map((t=>`%5C%22${t}%5C%22`)).join("%3AOR%3A"),r=`<tr>\n                            <td>${n}</td>\n                            <td>${a} ${t.length>1?`<span class="badge bg-info">\n                    <a href="${base_url}?command=search&col=2&q=${o}" target="_blank" class="link-light">Show all</a>\n                </span>`:""}</td>\n                            <td>${t.length}</td>\n                        </tr>`;e.append(r)})),n.DataTable({paging:!0,stateSave:!0,pageLength:10,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',columnDefs:[{targets:2,orderDataType:"dom-text"}],order:[[2,"desc"]]})):console.error("Invalid or empty data.")}(t.clusters),function(t){a.fn.dataTable.isDataTable("#ai-progress-table")&&a("#ai-progress-table").DataTable().clear().destroy();const e=a("#ai-progress-table tbody");e.empty(),t.forEach((t=>{const n=t.id||"N/A",a=t.prompt?t.prompt:"N/A",o=t.status||"N/A",r=t.ai_response?JSON.stringify(t.ai_response,null,2):"N/A",s=t.try_count||"X",i=Math.floor(Date.now()/1e3),c=t.time?Math.max(0,Math.ceil(9-(i-t.time))):"N/A",l=`\n                <tr id="row-${n}">\n                    <td>${n}</td>\n                    <td>${a}</td>\n                    <td>${o}</td>\n                    <td>${r}</td>\n                    <td>${s}</td>td>\n                    <td id="countdown-${n}">${"N/A"!==c?`${c} sec`:c}</td>\n                </tr>\n            `;e.append(l)})),a("#ai-progress-table").DataTable({paging:!0,stateSave:!0,pageLength:10,responsive:!0,lengthMenu:[[10,50,100,500,-1],[10,50,100,500,"All"]],dom:'rt<"container"<"row"<"col-md-6"li><"col-md-6"p>>>',order:[[0,"asc"]]})}(t.ai_formalization),function(){const e=a("#ai-statistics-container");e.empty(),t.ai_statistic.forEach((t=>{const n=t.Model||"N/A",o=t.Prompt_gen||"N/A",r=t.Avg_try_count||0,s=`ai-statistics-table-${n.replace(/\W/g,"-")}-${o.replace(/\W/g,"-")}`,i=`section-${s}`,c=`\n                <div class="ai-statistics-section" style="margin-bottom: 15px;">\n                    <h6 \n                        id="toggle-${s}" \n                        style="cursor: pointer; padding: 10px; background-color: #f1f1f1; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 5px; font-weight: bold;">\n                        ${n} - ${o}\n                        <span id="${s}-icon" style="float: right; color: #007bff;">[+]</span>\n                    </h6>\n                    <div id="${s}-content" style="display: none; padding: 10px; border: 1px solid #ccc; border-top: none; border-radius: 0 0 5px 5px;">\n                        <p>Average Try Count: ${r}</p>\n                        <table class="display ai-statistics-table">\n                            <thead>\n                                <tr>\n                                    <th>Status</th>\n                                    <th>Total</th>\n                                    <th>Percentage</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${t.Status_table.map((t=>`\n                                    <tr>\n                                        <td>${t.Status}</td>\n                                        <td>${t.Total}</td>\n                                        <td>${t.Percentage}%</td>\n                                    </tr>\n                                `)).join("")}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            `;e.append(c);const l="open"===localStorage.getItem(i),p=document.getElementById(`${s}-content`),d=document.getElementById(`${s}-icon`);l?(p.style.display="block",d.textContent="[-]"):(p.style.display="none",d.textContent="[+]"),document.getElementById(`toggle-${s}`).addEventListener("click",(()=>function(t,e){const n=document.getElementById(`${e}-content`),a=document.getElementById(`${e}-icon`);"none"===n.style.display?(n.style.display="block",a.textContent="[-]",localStorage.setItem(t,"open")):(n.style.display="none",a.textContent="[+]",localStorage.setItem(t,"closed"))}(i,s))),a(`#${s}-content .ai-statistics-table`).DataTable({paging:!1,searching:!1,info:!1,responsive:!0,order:[[1,"desc"]]})}))}()}()}))}function n(e){if(t.sim_methods&&Array.isArray(t.sim_methods[1])){const n=a("#clustering-process-select");n.empty(),t.sim_methods[1].forEach((function(t){const o=a("<option></option>").attr("value",t.name).text(`${t.name}: ${t.description}`);t.name===e?(o.prop("selected",!0),function(t,e,n){const o=a("#similarity-slider"),r=Math.min(t,e),s=Math.max(t,e),i=(e-t)/200;o.attr("step",i),o.attr("min",r),o.attr("max",s),currentVal=Math.max(r,Math.min(n,s)),o.val(currentVal),a("#slider-value").text(currentVal)}(t.interval[0],t.interval[1],t.default)):o.prop("selected",!1),n.append(o)}))}}function o(e){if(t.ai_models){const n=a("#ai-model-selection");n.empty(),t.ai_models.forEach((function(t){const o=a("<option></option>").attr("value",t.name).text(`${t.name}: ${t.description}`);t.name===e?o.prop("selected",!0):o.prop("selected",!1),n.append(o)}))}}function r(t){return Array.isArray(t)&&0!==t.length?t.map((t=>t.toString())).sort()[0]:""}function s(e=""){const n=document.getElementById("idDropdown");n.innerHTML="";const a=t.req_ids.filter((t=>t.toLowerCase().includes(e.toLowerCase())));if(a.forEach((t=>{const e=document.createElement("option");e.value=t,e.textContent=t,n.appendChild(e)})),0===a.length){const t=document.createElement("option");t.textContent="No matching IDs",t.disabled=!0,n.appendChild(t)}}a(document).ready((function(){e(),function(){const e=setInterval((function(){t&&(clearInterval(e),n(function(){const e=t.sim_methods[1].find((function(t){return t.selected}));return e?e.name:null}()),function(e){if(t.ai_methods){const n=a("#prompt-parsing-selection");n.empty(),t.ai_methods.forEach((function(t){const o=a("<option></option>").attr("value",t.name).text(`${t.name}: ${t.description}`);t.name===e?o.prop("selected",!0):o.prop("selected",!1),n.append(o)}))}}(function(){const e=t.ai_methods.find((function(t){return t.selected}));return e?e.name:null}()),o(function(){const e=t.ai_models.find((function(t){return t.selected}));return e?e.name:null}()),t.flags&&(a("#toggle-system-switch").prop("checked",t.flags.system).trigger("change"),a("#toggle-ai-switch").prop("checked",t.flags.ai).trigger("change")),s())}),30)}()})),setInterval(e,1e3),a("#terminate-all-button").click((function(){a.ajax({type:"POST",url:"/api/ai/terminate/all",contentType:"application/json"}).done((function(t){alert(t.message)})).fail((function(t){alert(`Error: ${t.responseText}`)}))})),a("#toggle-system-switch").on("change",(function(){const t=a(this).is(":checked");a.ajax({type:"POST",url:"/api/ai/set/flag/system",contentType:"application/json",data:JSON.stringify({system_enabled:t})})})),a("#toggle-ai-switch").on("change",(function(){const t=a(this).is(":checked");a.ajax({type:"POST",url:"/api/ai/set/flag/ai",contentType:"application/json",data:JSON.stringify({ai_enabled:t})})})),a("#clustering-process-select").on("change",(function(){const t=a(this).val();a.ajax({type:"POST",url:"/api/ai/set/sim/method",contentType:"application/json",data:JSON.stringify({name:t}),success:function(a){console.log(a.message),e(),n(t)},error:function(t){console.error("Error setting method:",t)}})})),a("#prompt-parsing-selection").on("change",(function(){const t=a(this).val();a.ajax({type:"POST",url:"/api/ai/set/ai/method",contentType:"application/json",data:JSON.stringify({name:t}),success:function(a){console.log(a.message),e(),n(t)},error:function(t){console.error("Error setting method:",t)}})})),a("#ai-model-selection").on("change",(function(){const t=a(this).val();a.ajax({type:"POST",url:"/api/ai/set/ai/model",contentType:"application/json",data:JSON.stringify({name:t}),success:function(n){console.log(n.message),e(),o(t)},error:function(t){console.error("Error setting method:",t)}})})),a("#start-clustering").click((function(){a.ajax({type:"POST",url:"/api/ai/set/sim/start",contentType:"application/json"})})),a("#terminate-clustering-button").click((function(){a.ajax({type:"POST",url:"/api/ai/terminate/sim",contentType:"application/json"}).done((function(t){alert(t.message)})).fail((function(t){alert(`Error: ${t.responseText}`)}))})),a("#terminate-ai-button").click((function(){a.ajax({type:"POST",url:"/api/ai/terminate/ai",contentType:"application/json"}).done((function(t){alert(t.message)})).fail((function(t){alert(`Error: ${t.responseText}`)}))})),a("#process-ai").click((function(){a.ajax({type:"POST",url:"/api/ai/ai/process",contentType:"application/json"})})),a("#submit-prompt-button").click((function(){var t=a("#user-prompt").val();t?a.ajax({type:"POST",url:"/api/ai/ai/query",contentType:"application/json",data:JSON.stringify({query:t}),success:function(t){a("#ai-response").text("Processing your query...")},error:function(t,e,n){a("#ai-response").text("Error: "+t.responseJSON.error)}}):alert("Please enter a prompt!")})),a("#submit-ids-button").click((function(){var t=a("#id-input").val().trim();t?a.ajax({type:"POST",url:"/api/ai/set/ids",contentType:"application/json",data:JSON.stringify({ids:t}),error:function(t){var e="An unknown error occurred.";t.responseJSON&&t.responseJSON.error?e=t.responseJSON.error:t.responseText&&(e=t.responseText),alert(e)}}):alert("Please enter at least one ID!")})),a("#get-matrix-button").click((function(){a.ajax({type:"GET",url:"/api/ai/get/sim/matrix",contentType:"application/json"}).done((function(e){const n=document.getElementById("similarity-matrix"),a=n.querySelector("thead"),o=n.querySelector("tbody");a.innerHTML="",o.innerHTML="";const r=e.matrix,s=e.indexing,i=document.createElement("tr");i.appendChild(document.createElement("th")),Object.keys(s).forEach((t=>{const e=document.createElement("th");e.textContent=t,i.appendChild(e)})),a.appendChild(i),Object.keys(s).forEach(((e,n)=>{const a=document.createElement("tr"),s=document.createElement("th");s.textContent=e,a.appendChild(s),r[n].forEach((e=>{const n=document.createElement("td");n.textContent=e.toFixed(2),n.style.backgroundColor=function(e){const n=t.sim_methods[0],a=.3+.4*Math.abs(e-n);return e>=n?`rgba(0, 0, 180, ${Math.min(a,.7)})`:`rgba(0, 180, 0, ${Math.min(a,.7)})`}(e),a.appendChild(n)})),o.appendChild(a)}))})).fail((function(){const t=document.getElementById("similarity-matrix"),e=t.querySelector("thead"),n=t.querySelector("tbody");e.innerHTML="",n.innerHTML=""}))})),a("#similarity-slider").on("change",(function(){a("#slider-value").text(a(this).val()),a.ajax({type:"POST",url:"/api/ai/set/sim/threshold",contentType:"application/json",data:JSON.stringify({threshold:a(this).val()}),success:function(t){console.log(t.message)},error:function(t){console.error("Error setting threshold:",t)}})})),a("#idSearch").on("input",(function(){s(a(this).val())})),a("#idDropdown").on("change",(function(){const t=a(this).val();a.ajax({type:"GET",url:"/api/ai/set/log/id?id="+t,contentType:"application/json",success:function(e){const n=e.data;let o="<h3>Log for ID: "+t+"</h3>";for(const[t,e]of Object.entries(n))o+=`\n                    <div class="log-entry">\n                        <p><strong>Time:</strong> ${t}</p>\n                        <p><strong>Message:</strong> ${e}</p>\n                    </div>\n                    <hr>\n                `;a("#log-container").html(o)},error:function(t){console.error("ERROR:",t)}})}))}))}},n={};function a(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={id:t,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.exports}a.m=e,t=[],a.O=(e,n,o,r)=>{if(!n){var s=1/0;for(p=0;p<t.length;p++){for(var[n,o,r]=t[p],i=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((t=>a.O[t](n[c])))?n.splice(c--,1):(i=!1,r<s&&(s=r));if(i){t.splice(p--,1);var l=o();void 0!==l&&(e=l)}}return e}r=r||0;for(var p=t.length;p>0&&t[p-1][2]>r;p--)t[p]=t[p-1];t[p]=[n,o,r]},a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.j=53,(()=>{var t={53:0};a.O.j=e=>0===t[e];var e=(e,n)=>{var o,r,[s,i,c]=n,l=0;if(s.some((e=>0!==t[e]))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(c)var p=c(a)}for(e&&e(n);l<s.length;l++)r=s[l],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(p)},n=self.webpackChunkhanfor=self.webpackChunkhanfor||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),a.nc=void 0;var o=a.O(void 0,[223],(()=>a(1245)));o=a.O(o)})();